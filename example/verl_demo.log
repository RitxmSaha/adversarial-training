2025-04-03 02:56:13,587	INFO worker.py:1843 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=75125)[0m {'actor_rollout_ref': {'actor': {'checkpoint': {'contents': ['model',
[36m(TaskRunner pid=75125)[0m                                                              'optimizer',
[36m(TaskRunner pid=75125)[0m                                                              'extra']},
[36m(TaskRunner pid=75125)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=75125)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=75125)[0m                                  'entropy_coeff': 0.001,
[36m(TaskRunner pid=75125)[0m                                  'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=75125)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=75125)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=75125)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=75125)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=75125)[0m                                  'kl_loss_coef': 0.001,
[36m(TaskRunner pid=75125)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=75125)[0m                                  'optim': {'lr': 1e-06,
[36m(TaskRunner pid=75125)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=75125)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=75125)[0m                                            'min_lr_ratio': None,
[36m(TaskRunner pid=75125)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=75125)[0m                                            'warmup_style': 'constant'},
[36m(TaskRunner pid=75125)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=75125)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=75125)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=75125)[0m                                  'ppo_micro_batch_size_per_gpu': 2,
[36m(TaskRunner pid=75125)[0m                                  'ppo_mini_batch_size': 32,
[36m(TaskRunner pid=75125)[0m                                  'shuffle': False,
[36m(TaskRunner pid=75125)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=75125)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=75125)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=75125)[0m                                  'use_kl_loss': False,
[36m(TaskRunner pid=75125)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=75125)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=75125)[0m                        'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=75125)[0m                                  'external_lib': None,
[36m(TaskRunner pid=75125)[0m                                  'override_config': {},
[36m(TaskRunner pid=75125)[0m                                  'path': 'Qwen/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=75125)[0m                                  'use_remove_padding': False},
[36m(TaskRunner pid=75125)[0m                        'ref': {'fsdp_config': {'param_offload': False,
[36m(TaskRunner pid=75125)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=75125)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=75125)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=75125)[0m                                'log_prob_micro_batch_size_per_gpu': 2,
[36m(TaskRunner pid=75125)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=75125)[0m                                'ulysses_sequence_parallel_size': 1},
[36m(TaskRunner pid=75125)[0m                        'rollout': {'disable_log_stats': True,
[36m(TaskRunner pid=75125)[0m                                    'do_sample': True,
[36m(TaskRunner pid=75125)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=75125)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=75125)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=75125)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=75125)[0m                                    'gpu_memory_utilization': 0.5,
[36m(TaskRunner pid=75125)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=75125)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=75125)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=75125)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=75125)[0m                                    'log_prob_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=75125)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=75125)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=75125)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=75125)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=75125)[0m                                    'n': 1,
[36m(TaskRunner pid=75125)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=75125)[0m                                    'prompt_length': 256,
[36m(TaskRunner pid=75125)[0m                                    'response_length': 512,
[36m(TaskRunner pid=75125)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=75125)[0m                                    'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=75125)[0m                                    'top_k': -1,
[36m(TaskRunner pid=75125)[0m                                    'top_p': 1,
[36m(TaskRunner pid=75125)[0m                                    'use_fire_sampling': False,
[36m(TaskRunner pid=75125)[0m                                    'val_kwargs': {'do_sample': False,
[36m(TaskRunner pid=75125)[0m                                                   'n': 1,
[36m(TaskRunner pid=75125)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=75125)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=75125)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=75125)[0m  'algorithm': {'adv_estimator': 'grpo',
[36m(TaskRunner pid=75125)[0m                'gamma': 1.0,
[36m(TaskRunner pid=75125)[0m                'kl_ctrl': {'horizon': 10000,
[36m(TaskRunner pid=75125)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=75125)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=75125)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=75125)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=75125)[0m                'lam': 1.0,
[36m(TaskRunner pid=75125)[0m                'use_kl_in_reward': False},
[36m(TaskRunner pid=75125)[0m  'critic': {'checkpoint': {'contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=75125)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=75125)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=75125)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=75125)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=75125)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=75125)[0m             'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=75125)[0m                       'external_lib': None,
[36m(TaskRunner pid=75125)[0m                       'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=75125)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=75125)[0m                                       'param_offload': False,
[36m(TaskRunner pid=75125)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=75125)[0m                       'override_config': {},
[36m(TaskRunner pid=75125)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=75125)[0m                       'tokenizer_path': 'Qwen/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=75125)[0m                       'use_remove_padding': False},
[36m(TaskRunner pid=75125)[0m             'optim': {'lr': 1e-05,
[36m(TaskRunner pid=75125)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=75125)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=75125)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=75125)[0m                       'warmup_style': 'constant'},
[36m(TaskRunner pid=75125)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=75125)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=75125)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=75125)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=75125)[0m             'ppo_mini_batch_size': 32,
[36m(TaskRunner pid=75125)[0m             'rollout_n': 1,
[36m(TaskRunner pid=75125)[0m             'shuffle': False,
[36m(TaskRunner pid=75125)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=75125)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=75125)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=75125)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=75125)[0m  'data': {'filter_overlong_prompts': False,
[36m(TaskRunner pid=75125)[0m           'image_key': 'images',
[36m(TaskRunner pid=75125)[0m           'max_prompt_length': 256,
[36m(TaskRunner pid=75125)[0m           'max_response_length': 512,
[36m(TaskRunner pid=75125)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=75125)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=75125)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=75125)[0m           'shuffle': True,
[36m(TaskRunner pid=75125)[0m           'tokenizer': None,
[36m(TaskRunner pid=75125)[0m           'train_batch_size': 64,
[36m(TaskRunner pid=75125)[0m           'train_files': './train.parquet',
[36m(TaskRunner pid=75125)[0m           'truncation': 'error',
[36m(TaskRunner pid=75125)[0m           'val_batch_size': None,
[36m(TaskRunner pid=75125)[0m           'val_files': './test.parquet'},
[36m(TaskRunner pid=75125)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=75125)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=75125)[0m                   'max_length': None,
[36m(TaskRunner pid=75125)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=75125)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=75125)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=75125)[0m                             'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=75125)[0m                                             'param_offload': False,
[36m(TaskRunner pid=75125)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=75125)[0m                             'input_tokenizer': 'Qwen/Qwen2.5-0.5B-Instruct',
[36m(TaskRunner pid=75125)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=75125)[0m                             'use_remove_padding': False},
[36m(TaskRunner pid=75125)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=75125)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=75125)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=75125)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=75125)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=75125)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=75125)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=75125)[0m              'default_local_dir': 'checkpoints/verl_examples/gsm8k',
[36m(TaskRunner pid=75125)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=75125)[0m              'experiment_name': 'gsm8k',
[36m(TaskRunner pid=75125)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=75125)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=75125)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=75125)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=75125)[0m              'n_gpus_per_node': 1,
[36m(TaskRunner pid=75125)[0m              'nnodes': 1,
[36m(TaskRunner pid=75125)[0m              'project_name': 'verl_examples',
[36m(TaskRunner pid=75125)[0m              'remove_previous_ckpt_in_save': True,
[36m(TaskRunner pid=75125)[0m              'resume_from_path': None,
[36m(TaskRunner pid=75125)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=75125)[0m              'save_freq': 10,
[36m(TaskRunner pid=75125)[0m              'test_freq': 10,
[36m(TaskRunner pid=75125)[0m              'total_epochs': 15,
[36m(TaskRunner pid=75125)[0m              'total_training_steps': None,
[36m(TaskRunner pid=75125)[0m              'val_before_train': False}}
[36m(TaskRunner pid=75125)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=75125)[0m dataset len: 7473
[36m(TaskRunner pid=75125)[0m dataset len: 1319
[36m(TaskRunner pid=75125)[0m Size of train dataloader: 116
[36m(TaskRunner pid=75125)[0m Total training steps: 1740
[36m(TaskRunner pid=75125)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(WorkerDict pid=75383)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=75383)[0m   "architectures": [
[36m(WorkerDict pid=75383)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=75383)[0m   ],
[36m(WorkerDict pid=75383)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=75383)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=75383)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=75383)[0m   "hidden_size": 896,
[36m(WorkerDict pid=75383)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=75383)[0m   "intermediate_size": 4864,
[36m(WorkerDict pid=75383)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=75383)[0m   "max_window_layers": 21,
[36m(WorkerDict pid=75383)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=75383)[0m   "num_attention_heads": 14,
[36m(WorkerDict pid=75383)[0m   "num_hidden_layers": 24,
[36m(WorkerDict pid=75383)[0m   "num_key_value_heads": 2,
[36m(WorkerDict pid=75383)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=75383)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=75383)[0m   "rope_scaling": null,
[36m(WorkerDict pid=75383)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=75383)[0m   "sliding_window": 32768,
[36m(WorkerDict pid=75383)[0m   "tie_word_embeddings": true,
[36m(WorkerDict pid=75383)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=75383)[0m   "transformers_version": "4.50.3",
[36m(WorkerDict pid=75383)[0m   "use_cache": true,
[36m(WorkerDict pid=75383)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=75383)[0m   "vocab_size": 151936
[36m(WorkerDict pid=75383)[0m }
[36m(WorkerDict pid=75383)[0m 
[36m(WorkerDict pid=75383)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=75383)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=75383)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=75383)[0m [rank0]:[W403 02:56:29.763260711 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[36m(WorkerDict pid=75383)[0m Qwen2ForCausalLM contains 494.03M parameters
[36m(WorkerDict pid=75383)[0m wrap_policy: functools.partial(<function _or_policy at 0x701e3c5f79a0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x701e3c5f7880>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_init_utils.py:444: UserWarning: FSDP is switching to use `NO_SHARD` instead of ShardingStrategy.FULL_SHARD since the world size is 1.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(WorkerDict pid=75383)[0m Total steps: 1740, num_warmup_steps: 0
[36m(WorkerDict pid=75383)[0m Actor use_remove_padding=False
[36m(WorkerDict pid=75383)[0m Before building vllm rollout, memory allocated (GB): 1.8410844802856445, memory reserved (GB): 2.95703125
[36m(WorkerDict pid=75383)[0m WARNING 04-03 02:56:37 [cuda.py:95] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=75383)[0m WARNING 04-03 02:56:38 [utils.py:2321] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x701dddd421d0>
[36m(WorkerDict pid=75383)[0m WARNING 04-03 02:56:38 [topk_topp_sampler.py:63] FlashInfer is not available. Falling back to the PyTorch-native implementation of top-p & top-k sampling. For the best performance, please install FlashInfer.
[36m(WorkerDict pid=75383)[0m Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]
[36m(WorkerDict pid=75383)[0m Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  6.34it/s]
[36m(WorkerDict pid=75383)[0m Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  6.33it/s]
[36m(WorkerDict pid=75383)[0m 
[36m(WorkerDict pid=75383)[0m kwargs: {'n': 1, 'logprobs': 0, 'max_tokens': 512, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=75383)[0m After building vllm rollout, memory allocated (GB): 4.950797080993652, memory reserved (GB): 10.6328125
[36m(WorkerDict pid=75383)[0m After building sharding manager, memory allocated (GB): 4.950797080993652, memory reserved (GB): 10.6328125
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(TaskRunner pid=75125)[0m wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
[36m(TaskRunner pid=75125)[0m wandb: Currently logged in as: ritamsaha (ritamsaha-uc-santa-barbara) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[36m(TaskRunner pid=75125)[0m wandb: Tracking run with wandb version 0.19.9
[36m(TaskRunner pid=75125)[0m wandb: Run data is saved locally in /home/ubuntu/adversarial-training/example/wandb/run-20250403_025642-wmqmvslz
[36m(TaskRunner pid=75125)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(TaskRunner pid=75125)[0m wandb: Syncing run gsm8k
[36m(TaskRunner pid=75125)[0m wandb: ⭐️ View project at https://wandb.ai/ritamsaha-uc-santa-barbara/verl_examples
[36m(TaskRunner pid=75125)[0m wandb: 🚀 View run at https://wandb.ai/ritamsaha-uc-santa-barbara/verl_examples/runs/wmqmvslz
[36m(TaskRunner pid=75125)[0m Using LocalLogger is deprecated. The constructor API will change 
[36m(TaskRunner pid=75125)[0m Checkpoint tracker file does not exist: %s /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=75125)[0m Training from scratch
[36m(TaskRunner pid=75125)[0m Training Progress:   0%|          | 0/1740 [00:00<?, ?it/s]
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:773: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:711: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(TaskRunner pid=75125)[0m step:1 - global_seqlen/min:27954.000 - global_seqlen/max:27954.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:27954.000 - global_seqlen/balanced_max:27954.000 - global_seqlen/mean:27954.000 - actor/entropy_loss:0.484 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.017 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.118 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:331.969 - response_length/max:512.000 - response_length/min:100.000 - response_length/clip_ratio:0.141 - prompt_length/mean:104.812 - prompt_length/max:170.000 - prompt_length/min:66.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.890 - timing_s/old_log_prob:2.666 - timing_s/adv:0.024 - timing_s/update_actor:10.404 - timing_s/step:20.989 - timing_per_token_ms/gen:0.371 - timing_per_token_ms/update_actor:0.372 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:27954.000 - perf/time_per_step:20.989 - perf/throughput:1331.855
[36m(TaskRunner pid=75125)[0m Training Progress:   0%|          | 1/1740 [00:21<10:17:02, 21.29s/it]
[36m(TaskRunner pid=75125)[0m step:2 - global_seqlen/min:27939.000 - global_seqlen/max:27939.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:27939.000 - global_seqlen/balanced_max:27939.000 - global_seqlen/mean:27939.000 - actor/entropy_loss:0.475 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.018 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.154 - actor/lr:0.000 - critic/score/mean:0.016 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.016 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.017 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.017 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:330.766 - response_length/max:512.000 - response_length/min:133.000 - response_length/clip_ratio:0.172 - prompt_length/mean:105.781 - prompt_length/max:162.000 - prompt_length/min:75.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.868 - timing_s/old_log_prob:2.364 - timing_s/adv:0.023 - timing_s/update_actor:10.604 - timing_s/step:20.861 - timing_per_token_ms/gen:0.372 - timing_per_token_ms/update_actor:0.380 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:27939.000 - perf/time_per_step:20.861 - perf/throughput:1339.317
[36m(TaskRunner pid=75125)[0m Training Progress:   0%|          | 2/1740 [00:42<10:09:25, 21.04s/it]
[36m(TaskRunner pid=75125)[0m step:3 - global_seqlen/min:28182.000 - global_seqlen/max:28182.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:28182.000 - global_seqlen/balanced_max:28182.000 - global_seqlen/mean:28182.000 - actor/entropy_loss:0.519 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.608 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.176 - actor/lr:0.000 - critic/score/mean:0.016 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.016 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.008 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.008 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:333.000 - response_length/max:512.000 - response_length/min:78.000 - response_length/clip_ratio:0.141 - prompt_length/mean:107.344 - prompt_length/max:189.000 - prompt_length/min:75.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.735 - timing_s/old_log_prob:2.363 - timing_s/adv:0.022 - timing_s/update_actor:10.477 - timing_s/step:20.600 - timing_per_token_ms/gen:0.363 - timing_per_token_ms/update_actor:0.372 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:28182.000 - perf/time_per_step:20.600 - perf/throughput:1368.038
[36m(TaskRunner pid=75125)[0m Training Progress:   0%|          | 3/1740 [01:02<10:03:18, 20.84s/it]
[36m(TaskRunner pid=75125)[0m step:4 - global_seqlen/min:25774.000 - global_seqlen/max:25774.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:25774.000 - global_seqlen/balanced_max:25774.000 - global_seqlen/mean:25774.000 - actor/entropy_loss:0.548 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.463 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.147 - actor/lr:0.000 - critic/score/mean:0.016 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.016 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.009 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.009 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:301.750 - response_length/max:512.000 - response_length/min:134.000 - response_length/clip_ratio:0.109 - prompt_length/mean:100.969 - prompt_length/max:150.000 - prompt_length/min:70.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.508 - timing_s/old_log_prob:2.360 - timing_s/adv:0.021 - timing_s/update_actor:10.220 - timing_s/step:20.112 - timing_per_token_ms/gen:0.389 - timing_per_token_ms/update_actor:0.397 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:25774.000 - perf/time_per_step:20.112 - perf/throughput:1281.549
[36m(TaskRunner pid=75125)[0m Training Progress:   0%|          | 4/1740 [01:22<9:54:40, 20.55s/it] 
[36m(TaskRunner pid=75125)[0m step:5 - global_seqlen/min:25112.000 - global_seqlen/max:25112.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:25112.000 - global_seqlen/balanced_max:25112.000 - global_seqlen/mean:25112.000 - actor/entropy_loss:0.469 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.018 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.153 - actor/lr:0.000 - critic/score/mean:0.000 - critic/score/max:0.000 - critic/score/min:0.000 - critic/rewards/mean:0.000 - critic/rewards/max:0.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.000 - critic/advantages/min:0.000 - critic/returns/mean:0.000 - critic/returns/max:0.000 - critic/returns/min:0.000 - response_length/mean:290.641 - response_length/max:512.000 - response_length/min:92.000 - response_length/clip_ratio:0.078 - prompt_length/mean:101.734 - prompt_length/max:162.000 - prompt_length/min:73.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.621 - timing_s/old_log_prob:2.356 - timing_s/adv:0.021 - timing_s/update_actor:10.456 - timing_s/step:20.457 - timing_per_token_ms/gen:0.410 - timing_per_token_ms/update_actor:0.416 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:25112.000 - perf/time_per_step:20.457 - perf/throughput:1227.540
[36m(TaskRunner pid=75125)[0m Training Progress:   0%|          | 5/1740 [01:43<9:53:21, 20.52s/it]
[36m(TaskRunner pid=75125)[0m step:6 - global_seqlen/min:25503.000 - global_seqlen/max:25503.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:25503.000 - global_seqlen/balanced_max:25503.000 - global_seqlen/mean:25503.000 - actor/entropy_loss:0.520 - actor/pg_loss:-0.017 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.448 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.160 - actor/lr:0.000 - critic/score/mean:0.016 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.016 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.016 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.016 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:291.219 - response_length/max:512.000 - response_length/min:4.000 - response_length/clip_ratio:0.094 - prompt_length/mean:107.266 - prompt_length/max:183.000 - prompt_length/min:65.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.268 - timing_s/old_log_prob:2.362 - timing_s/adv:0.021 - timing_s/update_actor:10.572 - timing_s/step:20.225 - timing_per_token_ms/gen:0.390 - timing_per_token_ms/update_actor:0.415 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:25503.000 - perf/time_per_step:20.225 - perf/throughput:1260.947
[36m(TaskRunner pid=75125)[0m Training Progress:   0%|          | 6/1740 [02:03<9:50:08, 20.42s/it]
[36m(TaskRunner pid=75125)[0m step:7 - global_seqlen/min:26761.000 - global_seqlen/max:26761.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:26761.000 - global_seqlen/balanced_max:26761.000 - global_seqlen/mean:26761.000 - actor/entropy_loss:0.524 - actor/pg_loss:-0.041 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.678 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.159 - actor/lr:0.000 - critic/score/mean:0.047 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.047 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.036 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.036 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:310.547 - response_length/max:512.000 - response_length/min:53.000 - response_length/clip_ratio:0.125 - prompt_length/mean:107.594 - prompt_length/max:191.000 - prompt_length/min:69.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.603 - timing_s/old_log_prob:2.348 - timing_s/adv:0.022 - timing_s/update_actor:10.497 - timing_s/step:20.472 - timing_per_token_ms/gen:0.383 - timing_per_token_ms/update_actor:0.392 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:26761.000 - perf/time_per_step:20.472 - perf/throughput:1307.215
[36m(TaskRunner pid=75125)[0m Training Progress:   0%|          | 7/1740 [02:24<9:50:18, 20.44s/it]
[36m(TaskRunner pid=75125)[0m step:8 - global_seqlen/min:25950.000 - global_seqlen/max:25950.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:25950.000 - global_seqlen/balanced_max:25950.000 - global_seqlen/mean:25950.000 - actor/entropy_loss:0.531 - actor/pg_loss:-0.047 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.669 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.163 - actor/lr:0.000 - critic/score/mean:0.047 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.047 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.047 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.047 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:301.672 - response_length/max:512.000 - response_length/min:39.000 - response_length/clip_ratio:0.109 - prompt_length/mean:103.797 - prompt_length/max:215.000 - prompt_length/min:69.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.597 - timing_s/old_log_prob:2.357 - timing_s/adv:0.022 - timing_s/update_actor:10.259 - timing_s/step:20.237 - timing_per_token_ms/gen:0.393 - timing_per_token_ms/update_actor:0.395 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:25950.000 - perf/time_per_step:20.237 - perf/throughput:1282.313
[36m(TaskRunner pid=75125)[0m Training Progress:   0%|          | 8/1740 [02:44<9:48:09, 20.37s/it]
[36m(TaskRunner pid=75125)[0m step:9 - global_seqlen/min:26677.000 - global_seqlen/max:26677.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:26677.000 - global_seqlen/balanced_max:26677.000 - global_seqlen/mean:26677.000 - actor/entropy_loss:0.762 - actor/pg_loss:-0.030 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.021 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.159 - actor/lr:0.000 - critic/score/mean:0.031 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.031 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.034 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.034 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:311.875 - response_length/max:512.000 - response_length/min:7.000 - response_length/clip_ratio:0.188 - prompt_length/mean:104.953 - prompt_length/max:186.000 - prompt_length/min:70.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.368 - timing_s/old_log_prob:2.365 - timing_s/adv:0.022 - timing_s/update_actor:10.596 - timing_s/step:20.353 - timing_per_token_ms/gen:0.369 - timing_per_token_ms/update_actor:0.397 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:26677.000 - perf/time_per_step:20.353 - perf/throughput:1310.717
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|          | 9/1740 [03:04<9:47:45, 20.37s/it]
[36m(TaskRunner pid=75125)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=75125)[0m validation generation end
[36m(TaskRunner pid=75125)[0m [prompt] system
[36m(TaskRunner pid=75125)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=75125)[0m user
[36m(TaskRunner pid=75125)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=75125)[0m assistant
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m [response] To determine how much Janet makes at the farmers' market every day, we need to follow these steps:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 1. **Calculate the total number of eggs laid by the ducks in a day:**
[36m(TaskRunner pid=75125)[0m    - Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 2. **Determine the number of eggs Janet eats in a day:**
[36m(TaskRunner pid=75125)[0m    - Janet eats 3 eggs for breakfast every morning.
[36m(TaskRunner pid=75125)[0m    - She eats 4 eggs for baking muffins every day.
[36m(TaskRunner pid=75125)[0m    - Therefore, the total number of eggs she eats in a day is:
[36m(TaskRunner pid=75125)[0m      \[
[36m(TaskRunner pid=75125)[0m      3 \text{ (breakfast)} + 4 \text{ (baking)} = 7 \text{ eggs}
[36m(TaskRunner pid=75125)[0m      \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 3. **Calculate the number of eggs Janet sells in a day:**
[36m(TaskRunner pid=75125)[0m    - The total number of eggs laid by the ducks is 16.
[36m(TaskRunner pid=75125)[0m    - Subtract the number of eggs she eats from the total number of eggs:
[36m(TaskRunner pid=75125)[0m      \[
[36m(TaskRunner pid=75125)[0m      16 \text{ (total)} - 7 \text{ (eaten)} = 9 \text{ eggs}
[36m(TaskRunner pid=75125)[0m      \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 4. **Determine the price at which Janet sells the eggs:**
[36m(TaskRunner pid=75125)[0m    - Janet sells the eggs at $2 per fresh duck egg.
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 5. **Calculate the total revenue from selling the eggs:**
[36m(TaskRunner pid=75125)[0m    - Multiply the number of eggs sold by the price per egg:
[36m(TaskRunner pid=75125)[0m      \[
[36m(TaskRunner pid=75125)[0m      9 \text{ eggs} \times 2 \text{ dollars/egg} = 18 \text{ dollars}
[36m(TaskRunner pid=75125)[0m      \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m ### Conclusion:
[36m(TaskRunner pid=75125)[0m #### Janet makes **$18** every day at the farmers' market.
[36m(TaskRunner pid=75125)[0m [ground_truth] 18
[36m(TaskRunner pid=75125)[0m [score] 0.0
[36m(TaskRunner pid=75125)[0m local_global_step_folder: checkpoints/verl_examples/gsm8k/global_step_10
[36m(TaskRunner pid=75125)[0m Warning: remove_previous_ckpt_in_save is deprecated, set max_actor_ckpt_to_keep=1 and max_critic_ckpt_to_keep=1 instead
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving model to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_10/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving checkpoint to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_10/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving extra_state to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_10/actor/extra_state_world_size_1_rank_0.pt
[36m(TaskRunner pid=75125)[0m step:10 - global_seqlen/min:25364.000 - global_seqlen/max:25364.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:25364.000 - global_seqlen/balanced_max:25364.000 - global_seqlen/mean:25364.000 - actor/entropy_loss:0.864 - actor/pg_loss:-0.084 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.938 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.164 - actor/lr:0.000 - val/test_score/openai/gsm8k:0.090 - critic/score/mean:0.094 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.094 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.083 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.083 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:291.312 - response_length/max:512.000 - response_length/min:4.000 - response_length/clip_ratio:0.078 - prompt_length/mean:105.000 - prompt_length/max:141.000 - prompt_length/min:76.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.647 - timing_s/old_log_prob:2.354 - timing_s/adv:0.021 - timing_s/update_actor:10.296 - timing_s/testing:46.227 - timing_s/save_checkpoint:10.668 - timing_s/step:77.215 - timing_per_token_ms/gen:0.410 - timing_per_token_ms/update_actor:0.406 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:25364.000 - perf/time_per_step:77.215 - perf/throughput:328.485
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|          | 10/1740 [04:21<18:13:25, 37.92s/it]
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:773: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:711: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(TaskRunner pid=75125)[0m step:11 - global_seqlen/min:21937.000 - global_seqlen/max:21937.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:21937.000 - global_seqlen/balanced_max:21937.000 - global_seqlen/mean:21937.000 - actor/entropy_loss:0.682 - actor/pg_loss:-0.083 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.773 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.424 - actor/lr:0.000 - critic/score/mean:0.078 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.078 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.068 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.068 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:241.312 - response_length/max:512.000 - response_length/min:4.000 - response_length/clip_ratio:0.031 - prompt_length/mean:101.453 - prompt_length/max:150.000 - prompt_length/min:67.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.395 - timing_s/old_log_prob:2.364 - timing_s/adv:0.020 - timing_s/update_actor:10.440 - timing_s/step:20.222 - timing_per_token_ms/gen:0.479 - timing_per_token_ms/update_actor:0.476 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:21937.000 - perf/time_per_step:20.222 - perf/throughput:1084.817
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|          | 11/1740 [04:42<15:36:42, 32.51s/it]
[36m(TaskRunner pid=75125)[0m step:12 - global_seqlen/min:24139.000 - global_seqlen/max:24139.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:24139.000 - global_seqlen/balanced_max:24139.000 - global_seqlen/mean:24139.000 - actor/entropy_loss:0.692 - actor/pg_loss:-0.070 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.655 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.317 - actor/lr:0.000 - critic/score/mean:0.062 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.062 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.062 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.062 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:271.688 - response_length/max:512.000 - response_length/min:9.000 - response_length/clip_ratio:0.109 - prompt_length/mean:105.484 - prompt_length/max:190.000 - prompt_length/min:74.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.735 - timing_s/old_log_prob:2.361 - timing_s/adv:0.021 - timing_s/update_actor:10.682 - timing_s/step:20.802 - timing_per_token_ms/gen:0.445 - timing_per_token_ms/update_actor:0.443 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:24139.000 - perf/time_per_step:20.802 - perf/throughput:1160.415
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|          | 12/1740 [05:02<13:53:39, 28.95s/it]
[36m(TaskRunner pid=75125)[0m step:13 - global_seqlen/min:25875.000 - global_seqlen/max:25875.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:25875.000 - global_seqlen/balanced_max:25875.000 - global_seqlen/mean:25875.000 - actor/entropy_loss:0.778 - actor/pg_loss:-0.045 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.543 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.321 - actor/lr:0.000 - critic/score/mean:0.047 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.047 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.039 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.039 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:297.766 - response_length/max:512.000 - response_length/min:5.000 - response_length/clip_ratio:0.141 - prompt_length/mean:106.531 - prompt_length/max:206.000 - prompt_length/min:73.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.594 - timing_s/old_log_prob:2.361 - timing_s/adv:0.021 - timing_s/update_actor:10.591 - timing_s/step:20.570 - timing_per_token_ms/gen:0.398 - timing_per_token_ms/update_actor:0.409 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:25875.000 - perf/time_per_step:20.570 - perf/throughput:1257.907
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|          | 13/1740 [05:23<12:40:09, 26.41s/it]
[36m(TaskRunner pid=75125)[0m step:14 - global_seqlen/min:24116.000 - global_seqlen/max:24116.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:24116.000 - global_seqlen/balanced_max:24116.000 - global_seqlen/mean:24116.000 - actor/entropy_loss:0.798 - actor/pg_loss:-0.106 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.815 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.316 - actor/lr:0.000 - critic/score/mean:0.125 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.125 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.104 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.104 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:274.844 - response_length/max:512.000 - response_length/min:5.000 - response_length/clip_ratio:0.078 - prompt_length/mean:101.969 - prompt_length/max:164.000 - prompt_length/min:71.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.582 - timing_s/old_log_prob:2.354 - timing_s/adv:0.021 - timing_s/update_actor:10.512 - timing_s/step:20.472 - timing_per_token_ms/gen:0.431 - timing_per_token_ms/update_actor:0.436 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:24116.000 - perf/time_per_step:20.472 - perf/throughput:1178.025
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|          | 14/1740 [05:43<11:48:08, 24.62s/it]
[36m(TaskRunner pid=75125)[0m step:15 - global_seqlen/min:26340.000 - global_seqlen/max:26340.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:26340.000 - global_seqlen/balanced_max:26340.000 - global_seqlen/mean:26340.000 - actor/entropy_loss:0.880 - actor/pg_loss:-0.102 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.363 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.436 - actor/lr:0.000 - critic/score/mean:0.125 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.125 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.081 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.081 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:308.672 - response_length/max:512.000 - response_length/min:91.000 - response_length/clip_ratio:0.125 - prompt_length/mean:102.891 - prompt_length/max:173.000 - prompt_length/min:71.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.548 - timing_s/old_log_prob:2.362 - timing_s/adv:0.022 - timing_s/update_actor:10.644 - timing_s/step:20.579 - timing_per_token_ms/gen:0.382 - timing_per_token_ms/update_actor:0.404 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:26340.000 - perf/time_per_step:20.579 - perf/throughput:1279.963
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|          | 15/1740 [06:04<11:12:45, 23.40s/it]
[36m(TaskRunner pid=75125)[0m step:16 - global_seqlen/min:24785.000 - global_seqlen/max:24785.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:24785.000 - global_seqlen/balanced_max:24785.000 - global_seqlen/mean:24785.000 - actor/entropy_loss:0.909 - actor/pg_loss:-0.061 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.409 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.336 - actor/lr:0.000 - critic/score/mean:0.078 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.078 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.061 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.061 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:284.000 - response_length/max:512.000 - response_length/min:117.000 - response_length/clip_ratio:0.078 - prompt_length/mean:103.266 - prompt_length/max:199.000 - prompt_length/min:74.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.727 - timing_s/old_log_prob:2.366 - timing_s/adv:0.021 - timing_s/update_actor:10.682 - timing_s/step:20.798 - timing_per_token_ms/gen:0.425 - timing_per_token_ms/update_actor:0.431 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:24785.000 - perf/time_per_step:20.798 - perf/throughput:1191.687
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|          | 16/1740 [06:25<10:49:53, 22.62s/it]
[36m(TaskRunner pid=75125)[0m step:17 - global_seqlen/min:24105.000 - global_seqlen/max:24105.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:24105.000 - global_seqlen/balanced_max:24105.000 - global_seqlen/mean:24105.000 - actor/entropy_loss:0.826 - actor/pg_loss:-0.144 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.585 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.318 - actor/lr:0.000 - critic/score/mean:0.172 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.172 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.133 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.133 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:280.781 - response_length/max:512.000 - response_length/min:4.000 - response_length/clip_ratio:0.094 - prompt_length/mean:95.859 - prompt_length/max:147.000 - prompt_length/min:66.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.557 - timing_s/old_log_prob:2.359 - timing_s/adv:0.021 - timing_s/update_actor:10.656 - timing_s/step:20.596 - timing_per_token_ms/gen:0.421 - timing_per_token_ms/update_actor:0.442 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:24105.000 - perf/time_per_step:20.596 - perf/throughput:1170.360
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|          | 17/1740 [06:45<10:32:06, 22.01s/it]
[36m(TaskRunner pid=75125)[0m step:18 - global_seqlen/min:24181.000 - global_seqlen/max:24181.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:24181.000 - global_seqlen/balanced_max:24181.000 - global_seqlen/mean:24181.000 - actor/entropy_loss:0.796 - actor/pg_loss:-0.155 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.908 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.327 - actor/lr:0.000 - critic/score/mean:0.172 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.172 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.121 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.121 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:277.734 - response_length/max:512.000 - response_length/min:5.000 - response_length/clip_ratio:0.078 - prompt_length/mean:100.094 - prompt_length/max:146.000 - prompt_length/min:72.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.490 - timing_s/old_log_prob:2.360 - timing_s/adv:0.020 - timing_s/update_actor:10.679 - timing_s/step:20.551 - timing_per_token_ms/gen:0.421 - timing_per_token_ms/update_actor:0.442 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:24181.000 - perf/time_per_step:20.551 - perf/throughput:1176.605
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|          | 18/1740 [07:06<10:19:11, 21.57s/it]
[36m(TaskRunner pid=75125)[0m step:19 - global_seqlen/min:25830.000 - global_seqlen/max:25830.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:25830.000 - global_seqlen/balanced_max:25830.000 - global_seqlen/mean:25830.000 - actor/entropy_loss:0.890 - actor/pg_loss:-0.127 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.520 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.316 - actor/lr:0.000 - critic/score/mean:0.141 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.141 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.110 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.110 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:301.531 - response_length/max:512.000 - response_length/min:5.000 - response_length/clip_ratio:0.156 - prompt_length/mean:102.062 - prompt_length/max:256.000 - prompt_length/min:73.000 - prompt_length/clip_ratio:0.016 - timing_s/gen:7.710 - timing_s/old_log_prob:2.358 - timing_s/adv:0.021 - timing_s/update_actor:10.580 - timing_s/step:20.672 - timing_per_token_ms/gen:0.400 - timing_per_token_ms/update_actor:0.410 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:25830.000 - perf/time_per_step:20.672 - perf/throughput:1249.519
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|          | 19/1740 [07:27<10:11:06, 21.31s/it]
[36m(TaskRunner pid=75125)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=75125)[0m validation generation end
[36m(TaskRunner pid=75125)[0m [prompt] system
[36m(TaskRunner pid=75125)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=75125)[0m user
[36m(TaskRunner pid=75125)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=75125)[0m assistant
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m [response] To calculate how much Janet makes at the farmers' market every day, we need to follow these steps:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 1. **Calculate the total number of eggs laid by the ducks in a day:**
[36m(TaskRunner pid=75125)[0m    - Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 2. **Subtract the number of eggs Janet eats for breakfast:**
[36m(TaskRunner pid=75125)[0m    - Janet eats 3 eggs for breakfast every morning.
[36m(TaskRunner pid=75125)[0m    - Therefore, the number of eggs she eats for breakfast is 3.
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 3. **Subtract the number of eggs she bakes for her friends:**
[36m(TaskRunner pid=75125)[0m    - Janet bakes 4 muffins for her friends every day.
[36m(TaskRunner pid=75125)[0m    - Therefore, the number of eggs she bakes for her friends is 4.
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 4. **Calculate the number of eggs she sells at the farmers' market:**
[36m(TaskRunner pid=75125)[0m    - The total number of eggs laid by the ducks is 16.
[36m(TaskRunner pid=75125)[0m    - Subtract the number of eggs she eats for breakfast and bakes for her friends:
[36m(TaskRunner pid=75125)[0m      \[
[36m(TaskRunner pid=75125)[0m      16 - 3 - 4 = 7
[36m(TaskRunner pid=75125)[0m      \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 5. **Calculate the total revenue from selling the eggs:**
[36m(TaskRunner pid=75125)[0m    - Janet sells each egg for $2.
[36m(TaskRunner pid=75125)[0m    - Therefore, the total revenue is:
[36m(TaskRunner pid=75125)[0m      \[
[36m(TaskRunner pid=75125)[0m      7 \text{ eggs} \times 2 \text{ dollars/egg} = 14 \text{ dollars}
[36m(TaskRunner pid=75125)[0m      \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 6. **Calculate the total earnings at the farmers' market:**
[36m(TaskRunner pid=75125)[0m    - The total earnings are the sum of the revenue from selling the eggs and the cost of the eggs:
[36m(TaskRunner pid=75125)[0m      \[
[36m(TaskRunner pid=75125)[0m      14 \text{ dollars} + 16 \text{ dollars} = 30 \text{ dollars}
[36m(TaskRunner pid=75125)[0m      \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m ### Final Answer:
[36m(TaskRunner pid=75125)[0m #### Janet makes **$30** at the farmers' market every day.
[36m(TaskRunner pid=75125)[0m [ground_truth] 18
[36m(TaskRunner pid=75125)[0m [score] 0.0
[36m(TaskRunner pid=75125)[0m local_global_step_folder: checkpoints/verl_examples/gsm8k/global_step_20
[36m(TaskRunner pid=75125)[0m Warning: remove_previous_ckpt_in_save is deprecated, set max_actor_ckpt_to_keep=1 and max_critic_ckpt_to_keep=1 instead
[36m(WorkerDict pid=75383)[0m Checkpoint manager remove previous save local path: /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_10/actor
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving model to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_20/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving checkpoint to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_20/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving extra_state to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_20/actor/extra_state_world_size_1_rank_0.pt
[36m(TaskRunner pid=75125)[0m step:20 - global_seqlen/min:22212.000 - global_seqlen/max:22212.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:22212.000 - global_seqlen/balanced_max:22212.000 - global_seqlen/mean:22212.000 - actor/entropy_loss:0.777 - actor/pg_loss:-0.143 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.109 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.313 - actor/lr:0.000 - val/test_score/openai/gsm8k:0.312 - critic/score/mean:0.141 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.141 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.105 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.105 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:245.453 - response_length/max:512.000 - response_length/min:5.000 - response_length/clip_ratio:0.078 - prompt_length/mean:101.609 - prompt_length/max:168.000 - prompt_length/min:69.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.414 - timing_s/old_log_prob:2.364 - timing_s/adv:0.020 - timing_s/update_actor:10.700 - timing_s/testing:42.917 - timing_s/save_checkpoint:12.192 - timing_s/step:75.611 - timing_per_token_ms/gen:0.472 - timing_per_token_ms/update_actor:0.482 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:22212.000 - perf/time_per_step:75.611 - perf/throughput:293.768
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|          | 20/1740 [08:42<17:58:12, 37.61s/it]
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:773: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:711: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(TaskRunner pid=75125)[0m step:21 - global_seqlen/min:24116.000 - global_seqlen/max:24116.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:24116.000 - global_seqlen/balanced_max:24116.000 - global_seqlen/mean:24116.000 - actor/entropy_loss:0.776 - actor/pg_loss:-0.114 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.792 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.385 - actor/lr:0.000 - critic/score/mean:0.125 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.125 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.096 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.096 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:271.703 - response_length/max:512.000 - response_length/min:55.000 - response_length/clip_ratio:0.094 - prompt_length/mean:105.109 - prompt_length/max:189.000 - prompt_length/min:74.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.258 - timing_s/old_log_prob:2.362 - timing_s/adv:0.021 - timing_s/update_actor:10.360 - timing_s/step:20.004 - timing_per_token_ms/gen:0.417 - timing_per_token_ms/update_actor:0.430 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:24116.000 - perf/time_per_step:20.004 - perf/throughput:1205.576
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|          | 21/1740 [09:02<15:26:10, 32.33s/it]
[36m(TaskRunner pid=75125)[0m step:22 - global_seqlen/min:22687.000 - global_seqlen/max:22687.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:22687.000 - global_seqlen/balanced_max:22687.000 - global_seqlen/mean:22687.000 - actor/entropy_loss:0.801 - actor/pg_loss:-0.112 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.178 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.328 - actor/lr:0.000 - critic/score/mean:0.141 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.141 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.107 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.107 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:246.922 - response_length/max:512.000 - response_length/min:5.000 - response_length/clip_ratio:0.078 - prompt_length/mean:107.562 - prompt_length/max:189.000 - prompt_length/min:67.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.531 - timing_s/old_log_prob:2.360 - timing_s/adv:0.020 - timing_s/update_actor:10.556 - timing_s/step:20.470 - timing_per_token_ms/gen:0.477 - timing_per_token_ms/update_actor:0.465 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:22687.000 - perf/time_per_step:20.470 - perf/throughput:1108.311
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|▏         | 22/1740 [09:23<13:43:46, 28.77s/it]
[36m(TaskRunner pid=75125)[0m step:23 - global_seqlen/min:24961.000 - global_seqlen/max:24961.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:24961.000 - global_seqlen/balanced_max:24961.000 - global_seqlen/mean:24961.000 - actor/entropy_loss:0.873 - actor/pg_loss:-0.127 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.194 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.330 - actor/lr:0.000 - critic/score/mean:0.141 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.141 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.107 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.107 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:285.172 - response_length/max:512.000 - response_length/min:6.000 - response_length/clip_ratio:0.078 - prompt_length/mean:104.844 - prompt_length/max:168.000 - prompt_length/min:68.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.790 - timing_s/old_log_prob:2.362 - timing_s/adv:0.020 - timing_s/update_actor:10.401 - timing_s/step:20.577 - timing_per_token_ms/gen:0.427 - timing_per_token_ms/update_actor:0.417 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:24961.000 - perf/time_per_step:20.577 - perf/throughput:1213.073
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|▏         | 23/1740 [09:43<12:32:57, 26.31s/it]
[36m(TaskRunner pid=75125)[0m step:24 - global_seqlen/min:24870.000 - global_seqlen/max:24870.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:24870.000 - global_seqlen/balanced_max:24870.000 - global_seqlen/mean:24870.000 - actor/entropy_loss:0.886 - actor/pg_loss:-0.190 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.455 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.320 - actor/lr:0.000 - critic/score/mean:0.234 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.234 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.185 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.185 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:287.734 - response_length/max:512.000 - response_length/min:62.000 - response_length/clip_ratio:0.031 - prompt_length/mean:100.859 - prompt_length/max:149.000 - prompt_length/min:70.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.693 - timing_s/old_log_prob:2.362 - timing_s/adv:0.021 - timing_s/update_actor:10.544 - timing_s/step:20.623 - timing_per_token_ms/gen:0.418 - timing_per_token_ms/update_actor:0.424 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:24870.000 - perf/time_per_step:20.623 - perf/throughput:1205.961
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|▏         | 24/1740 [10:04<11:43:43, 24.61s/it]
[36m(TaskRunner pid=75125)[0m step:25 - global_seqlen/min:24200.000 - global_seqlen/max:24200.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:24200.000 - global_seqlen/balanced_max:24200.000 - global_seqlen/mean:24200.000 - actor/entropy_loss:0.934 - actor/pg_loss:-0.154 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.198 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.324 - actor/lr:0.000 - critic/score/mean:0.188 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.188 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.137 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.137 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:270.703 - response_length/max:512.000 - response_length/min:85.000 - response_length/clip_ratio:0.047 - prompt_length/mean:107.422 - prompt_length/max:183.000 - prompt_length/min:70.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.433 - timing_s/old_log_prob:2.365 - timing_s/adv:0.021 - timing_s/update_actor:10.310 - timing_s/step:20.132 - timing_per_token_ms/gen:0.429 - timing_per_token_ms/update_actor:0.426 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:24200.000 - perf/time_per_step:20.132 - perf/throughput:1202.090
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|▏         | 25/1740 [10:24<11:04:59, 23.26s/it]
[36m(TaskRunner pid=75125)[0m step:26 - global_seqlen/min:22722.000 - global_seqlen/max:22722.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:22722.000 - global_seqlen/balanced_max:22722.000 - global_seqlen/mean:22722.000 - actor/entropy_loss:0.800 - actor/pg_loss:-0.229 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.542 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.329 - actor/lr:0.000 - critic/score/mean:0.266 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.266 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.195 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.195 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:254.766 - response_length/max:512.000 - response_length/min:41.000 - response_length/clip_ratio:0.062 - prompt_length/mean:100.266 - prompt_length/max:152.000 - prompt_length/min:71.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.525 - timing_s/old_log_prob:2.360 - timing_s/adv:0.020 - timing_s/update_actor:10.422 - timing_s/step:20.329 - timing_per_token_ms/gen:0.462 - timing_per_token_ms/update_actor:0.459 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:22722.000 - perf/time_per_step:20.329 - perf/throughput:1117.688
[36m(TaskRunner pid=75125)[0m Training Progress:   1%|▏         | 26/1740 [10:44<10:39:28, 22.39s/it]
[36m(TaskRunner pid=75125)[0m step:27 - global_seqlen/min:22247.000 - global_seqlen/max:22247.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:22247.000 - global_seqlen/balanced_max:22247.000 - global_seqlen/mean:22247.000 - actor/entropy_loss:0.661 - actor/pg_loss:-0.264 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.799 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.318 - actor/lr:0.000 - critic/score/mean:0.297 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.297 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.253 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.253 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:247.391 - response_length/max:512.000 - response_length/min:70.000 - response_length/clip_ratio:0.016 - prompt_length/mean:100.219 - prompt_length/max:151.000 - prompt_length/min:67.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.525 - timing_s/old_log_prob:2.360 - timing_s/adv:0.021 - timing_s/update_actor:10.427 - timing_s/step:20.334 - timing_per_token_ms/gen:0.475 - timing_per_token_ms/update_actor:0.469 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:22247.000 - perf/time_per_step:20.334 - perf/throughput:1094.056
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 27/1740 [11:05<10:21:35, 21.77s/it]
[36m(TaskRunner pid=75125)[0m step:28 - global_seqlen/min:23834.000 - global_seqlen/max:23834.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:23834.000 - global_seqlen/balanced_max:23834.000 - global_seqlen/mean:23834.000 - actor/entropy_loss:0.705 - actor/pg_loss:-0.301 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.966 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.320 - actor/lr:0.000 - critic/score/mean:0.328 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.328 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.231 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.231 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:270.094 - response_length/max:512.000 - response_length/min:94.000 - response_length/clip_ratio:0.109 - prompt_length/mean:102.312 - prompt_length/max:141.000 - prompt_length/min:63.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.564 - timing_s/old_log_prob:2.362 - timing_s/adv:0.020 - timing_s/update_actor:10.684 - timing_s/step:20.633 - timing_per_token_ms/gen:0.438 - timing_per_token_ms/update_actor:0.448 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:23834.000 - perf/time_per_step:20.633 - perf/throughput:1155.126
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 28/1740 [11:25<10:11:32, 21.43s/it]
[36m(TaskRunner pid=75125)[0m step:29 - global_seqlen/min:22092.000 - global_seqlen/max:22092.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:22092.000 - global_seqlen/balanced_max:22092.000 - global_seqlen/mean:22092.000 - actor/entropy_loss:0.554 - actor/pg_loss:-0.351 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.885 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.331 - actor/lr:0.000 - critic/score/mean:0.359 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.359 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.286 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.286 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:244.031 - response_length/max:512.000 - response_length/min:41.000 - response_length/clip_ratio:0.031 - prompt_length/mean:101.156 - prompt_length/max:177.000 - prompt_length/min:68.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.549 - timing_s/old_log_prob:2.366 - timing_s/adv:0.019 - timing_s/update_actor:10.565 - timing_s/step:20.502 - timing_per_token_ms/gen:0.483 - timing_per_token_ms/update_actor:0.478 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:22092.000 - perf/time_per_step:20.502 - perf/throughput:1077.544
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 29/1740 [11:46<10:03:14, 21.15s/it]
[36m(TaskRunner pid=75125)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=75125)[0m validation generation end
[36m(TaskRunner pid=75125)[0m [prompt] system
[36m(TaskRunner pid=75125)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=75125)[0m user
[36m(TaskRunner pid=75125)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=75125)[0m assistant
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m [response] To calculate how much Janet makes at the farmers' market every day, we need to follow these steps:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 1. Calculate the total number of eggs laid by the ducks in a day.
[36m(TaskRunner pid=75125)[0m 2. Subtract the number of eggs Janet eats for breakfast.
[36m(TaskRunner pid=75125)[0m 3. Subtract the number of eggs she bakes for her friends.
[36m(TaskRunner pid=75125)[0m 4. Subtract the number of eggs she sells at the farmers' market.
[36m(TaskRunner pid=75125)[0m 5. Calculate the total earnings from selling the remaining eggs.
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Let's start with the first step:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 1. Total eggs laid in a day:
[36m(TaskRunner pid=75125)[0m    \[
[36m(TaskRunner pid=75125)[0m    16 \text{ eggs/day} \times 7 \text{ days} = 112 \text{ eggs}
[36m(TaskRunner pid=75125)[0m    \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 2. Eggs eaten for breakfast:
[36m(TaskRunner pid=75125)[0m    \[
[36m(TaskRunner pid=75125)[0m    3 \text{ eggs/day} \times 7 \text{ days} = 21 \text{ eggs}
[36m(TaskRunner pid=75125)[0m    \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 3. Eggs baked for friends:
[36m(TaskRunner pid=75125)[0m    \[
[36m(TaskRunner pid=75125)[0m    4 \text{ eggs/day} \times 7 \text{ days} = 28 \text{ eggs}
[36m(TaskRunner pid=75125)[0m    \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 4. Eggs sold at the farmers' market:
[36m(TaskRunner pid=75125)[0m    \[
[36m(TaskRunner pid=75125)[0m    112 \text{ eggs} - 21 \text{ eggs} - 28 \text{ eggs} = 53 \text{ eggs}
[36m(TaskRunner pid=75125)[0m    \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m 5. Earnings from selling the remaining eggs:
[36m(TaskRunner pid=75125)[0m    \[
[36m(TaskRunner pid=75125)[0m    53 \text{ eggs} \times \$2/\text{egg} = \$106
[36m(TaskRunner pid=75125)[0m    \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Therefore, Janet makes **\$106** every day at the farmers' market. The final answer is:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m #### \$106
[36m(TaskRunner pid=75125)[0m [ground_truth] 18
[36m(TaskRunner pid=75125)[0m [score] 0.0
[36m(TaskRunner pid=75125)[0m local_global_step_folder: checkpoints/verl_examples/gsm8k/global_step_30
[36m(TaskRunner pid=75125)[0m Warning: remove_previous_ckpt_in_save is deprecated, set max_actor_ckpt_to_keep=1 and max_critic_ckpt_to_keep=1 instead
[36m(WorkerDict pid=75383)[0m Checkpoint manager remove previous save local path: /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_20/actor
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving model to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_30/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving checkpoint to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_30/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving extra_state to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_30/actor/extra_state_world_size_1_rank_0.pt
[36m(TaskRunner pid=75125)[0m step:30 - global_seqlen/min:21628.000 - global_seqlen/max:21628.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:21628.000 - global_seqlen/balanced_max:21628.000 - global_seqlen/mean:21628.000 - actor/entropy_loss:0.513 - actor/pg_loss:-0.295 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.930 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.327 - actor/lr:0.000 - val/test_score/openai/gsm8k:0.394 - critic/score/mean:0.297 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.297 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.236 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.236 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:230.281 - response_length/max:512.000 - response_length/min:3.000 - response_length/clip_ratio:0.031 - prompt_length/mean:107.656 - prompt_length/max:180.000 - prompt_length/min:70.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.388 - timing_s/old_log_prob:2.358 - timing_s/adv:0.021 - timing_s/update_actor:10.600 - timing_s/testing:37.934 - timing_s/save_checkpoint:12.132 - timing_s/step:70.435 - timing_per_token_ms/gen:0.501 - timing_per_token_ms/update_actor:0.490 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:21628.000 - perf/time_per_step:70.435 - perf/throughput:307.063
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 30/1740 [12:56<17:04:20, 35.94s/it]
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:773: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:711: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(TaskRunner pid=75125)[0m step:31 - global_seqlen/min:23485.000 - global_seqlen/max:23485.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:23485.000 - global_seqlen/balanced_max:23485.000 - global_seqlen/mean:23485.000 - actor/entropy_loss:0.603 - actor/pg_loss:-0.216 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.473 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.580 - actor/lr:0.000 - critic/score/mean:0.234 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.234 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.200 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.200 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:265.469 - response_length/max:512.000 - response_length/min:109.000 - response_length/clip_ratio:0.031 - prompt_length/mean:101.484 - prompt_length/max:159.000 - prompt_length/min:68.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.514 - timing_s/old_log_prob:2.372 - timing_s/adv:0.021 - timing_s/update_actor:10.502 - timing_s/step:20.412 - timing_per_token_ms/gen:0.442 - timing_per_token_ms/update_actor:0.447 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:23485.000 - perf/time_per_step:20.412 - perf/throughput:1150.555
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 31/1740 [13:17<14:51:03, 31.28s/it]
[36m(TaskRunner pid=75125)[0m step:32 - global_seqlen/min:22213.000 - global_seqlen/max:22213.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:22213.000 - global_seqlen/balanced_max:22213.000 - global_seqlen/mean:22213.000 - actor/entropy_loss:0.474 - actor/pg_loss:-0.340 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.888 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.373 - actor/lr:0.000 - critic/score/mean:0.375 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.375 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.322 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.322 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:245.047 - response_length/max:512.000 - response_length/min:36.000 - response_length/clip_ratio:0.047 - prompt_length/mean:102.031 - prompt_length/max:169.000 - prompt_length/min:73.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.417 - timing_s/old_log_prob:2.363 - timing_s/adv:0.020 - timing_s/update_actor:10.332 - timing_s/step:20.135 - timing_per_token_ms/gen:0.473 - timing_per_token_ms/update_actor:0.465 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:22213.000 - perf/time_per_step:20.135 - perf/throughput:1103.208
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 32/1740 [13:37<13:15:21, 27.94s/it]
[36m(TaskRunner pid=75125)[0m step:33 - global_seqlen/min:21615.000 - global_seqlen/max:21615.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:21615.000 - global_seqlen/balanced_max:21615.000 - global_seqlen/mean:21615.000 - actor/entropy_loss:0.418 - actor/pg_loss:-0.339 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.487 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.352 - actor/lr:0.000 - critic/score/mean:0.375 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.375 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.321 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.321 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:234.078 - response_length/max:512.000 - response_length/min:76.000 - response_length/clip_ratio:0.031 - prompt_length/mean:103.656 - prompt_length/max:161.000 - prompt_length/min:81.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.637 - timing_s/old_log_prob:2.360 - timing_s/adv:0.020 - timing_s/update_actor:10.293 - timing_s/step:20.312 - timing_per_token_ms/gen:0.510 - timing_per_token_ms/update_actor:0.476 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:21615.000 - perf/time_per_step:20.312 - perf/throughput:1064.139
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 33/1740 [13:57<12:09:48, 25.65s/it]
[36m(TaskRunner pid=75125)[0m step:34 - global_seqlen/min:22283.000 - global_seqlen/max:22283.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:22283.000 - global_seqlen/balanced_max:22283.000 - global_seqlen/mean:22283.000 - actor/entropy_loss:0.536 - actor/pg_loss:-0.345 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.947 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.350 - actor/lr:0.000 - critic/score/mean:0.375 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.375 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.287 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.287 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:244.297 - response_length/max:512.000 - response_length/min:92.000 - response_length/clip_ratio:0.047 - prompt_length/mean:103.875 - prompt_length/max:184.000 - prompt_length/min:68.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.760 - timing_s/old_log_prob:2.366 - timing_s/adv:0.020 - timing_s/update_actor:10.630 - timing_s/step:20.780 - timing_per_token_ms/gen:0.496 - timing_per_token_ms/update_actor:0.477 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:22283.000 - perf/time_per_step:20.780 - perf/throughput:1072.353
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 34/1740 [14:18<11:27:50, 24.19s/it]
[36m(TaskRunner pid=75125)[0m step:35 - global_seqlen/min:21420.000 - global_seqlen/max:21420.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:21420.000 - global_seqlen/balanced_max:21420.000 - global_seqlen/mean:21420.000 - actor/entropy_loss:0.527 - actor/pg_loss:-0.288 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.631 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.335 - actor/lr:0.000 - critic/score/mean:0.297 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.297 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.250 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.250 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:225.938 - response_length/max:512.000 - response_length/min:94.000 - response_length/clip_ratio:0.031 - prompt_length/mean:108.750 - prompt_length/max:201.000 - prompt_length/min:73.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.460 - timing_s/old_log_prob:2.358 - timing_s/adv:0.019 - timing_s/update_actor:10.609 - timing_s/step:20.449 - timing_per_token_ms/gen:0.516 - timing_per_token_ms/update_actor:0.495 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:21420.000 - perf/time_per_step:20.449 - perf/throughput:1047.462
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 35/1740 [14:38<10:55:33, 23.07s/it]
[36m(TaskRunner pid=75125)[0m step:36 - global_seqlen/min:22259.000 - global_seqlen/max:22259.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:22259.000 - global_seqlen/balanced_max:22259.000 - global_seqlen/mean:22259.000 - actor/entropy_loss:0.412 - actor/pg_loss:-0.411 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.068 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.345 - actor/lr:0.000 - critic/score/mean:0.469 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.469 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.371 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.371 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:248.516 - response_length/max:512.000 - response_length/min:85.000 - response_length/clip_ratio:0.062 - prompt_length/mean:99.281 - prompt_length/max:182.000 - prompt_length/min:72.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.538 - timing_s/old_log_prob:2.364 - timing_s/adv:0.020 - timing_s/update_actor:10.611 - timing_s/step:20.537 - timing_per_token_ms/gen:0.474 - timing_per_token_ms/update_actor:0.477 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:22259.000 - perf/time_per_step:20.537 - perf/throughput:1083.866
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 36/1740 [14:59<10:33:39, 22.31s/it]
[36m(TaskRunner pid=75125)[0m step:37 - global_seqlen/min:21228.000 - global_seqlen/max:21228.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:21228.000 - global_seqlen/balanced_max:21228.000 - global_seqlen/mean:21228.000 - actor/entropy_loss:0.371 - actor/pg_loss:-0.362 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.020 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.342 - actor/lr:0.000 - critic/score/mean:0.391 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.391 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.333 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.333 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:225.672 - response_length/max:512.000 - response_length/min:91.000 - response_length/clip_ratio:0.016 - prompt_length/mean:106.016 - prompt_length/max:184.000 - prompt_length/min:71.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.368 - timing_s/old_log_prob:2.365 - timing_s/adv:0.020 - timing_s/update_actor:10.626 - timing_s/step:20.382 - timing_per_token_ms/gen:0.510 - timing_per_token_ms/update_actor:0.501 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:21228.000 - perf/time_per_step:20.382 - perf/throughput:1041.511
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 37/1740 [15:19<10:16:52, 21.73s/it]
[36m(TaskRunner pid=75125)[0m step:38 - global_seqlen/min:20346.000 - global_seqlen/max:20346.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:20346.000 - global_seqlen/balanced_max:20346.000 - global_seqlen/mean:20346.000 - actor/entropy_loss:0.387 - actor/pg_loss:-0.448 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.566 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.346 - actor/lr:0.000 - critic/score/mean:0.500 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.500 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.414 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.414 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:217.219 - response_length/max:512.000 - response_length/min:67.000 - response_length/clip_ratio:0.016 - prompt_length/mean:100.688 - prompt_length/max:168.000 - prompt_length/min:71.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.271 - timing_s/old_log_prob:2.360 - timing_s/adv:0.019 - timing_s/update_actor:10.504 - timing_s/step:20.157 - timing_per_token_ms/gen:0.523 - timing_per_token_ms/update_actor:0.516 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:20346.000 - perf/time_per_step:20.157 - perf/throughput:1009.362
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 38/1740 [15:40<10:03:09, 21.26s/it]
[36m(TaskRunner pid=75125)[0m step:39 - global_seqlen/min:19887.000 - global_seqlen/max:19887.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:19887.000 - global_seqlen/balanced_max:19887.000 - global_seqlen/mean:19887.000 - actor/entropy_loss:0.310 - actor/pg_loss:-0.406 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.161 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.343 - actor/lr:0.000 - critic/score/mean:0.438 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.438 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.390 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.390 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:207.766 - response_length/max:512.000 - response_length/min:5.000 - response_length/clip_ratio:0.016 - prompt_length/mean:102.969 - prompt_length/max:171.000 - prompt_length/min:69.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.169 - timing_s/old_log_prob:2.366 - timing_s/adv:0.020 - timing_s/update_actor:10.493 - timing_s/step:20.050 - timing_per_token_ms/gen:0.539 - timing_per_token_ms/update_actor:0.528 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:19887.000 - perf/time_per_step:20.050 - perf/throughput:991.857
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 39/1740 [16:00<9:52:31, 20.90s/it] 
[36m(TaskRunner pid=75125)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=75125)[0m validation generation end
[36m(TaskRunner pid=75125)[0m [prompt] system
[36m(TaskRunner pid=75125)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=75125)[0m user
[36m(TaskRunner pid=75125)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=75125)[0m assistant
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m [response] First, we need to calculate the total number of eggs Janet's ducks lay in a day. Since she has 16 eggs per day, and she lays 16 eggs per day, the total number of eggs laid in a day is:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m \[ 16 \text{ eggs/day} \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Next, we need to determine how many eggs Janet eats in a day. She eats 3 eggs for breakfast and 4 eggs for baking muffins, so the total number of eggs she eats in a day is:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m \[ 3 \text{ eggs (breakfast)} + 4 \text{ eggs (baking)} = 7 \text{ eggs/day} \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Now, we subtract the number of eggs she eats from the total number of eggs she lays to find out how many eggs she sells at the farmers' market:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m \[ 16 \text{ eggs (total)} - 7 \text{ eggs (eaten)} = 9 \text{ eggs/day} \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Since she sells each egg for $2, the total amount of money she makes every day is:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m \[ 9 \text{ eggs/day} \times 2 \text{ dollars/egg} = 18 \text{ dollars/day} \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Therefore, the final answer is:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m #### 18
[36m(TaskRunner pid=75125)[0m [ground_truth] 18
[36m(TaskRunner pid=75125)[0m [score] 1.0
[36m(TaskRunner pid=75125)[0m local_global_step_folder: checkpoints/verl_examples/gsm8k/global_step_40
[36m(TaskRunner pid=75125)[0m Warning: remove_previous_ckpt_in_save is deprecated, set max_actor_ckpt_to_keep=1 and max_critic_ckpt_to_keep=1 instead
[36m(WorkerDict pid=75383)[0m Checkpoint manager remove previous save local path: /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_30/actor
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving model to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_40/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving checkpoint to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_40/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving extra_state to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_40/actor/extra_state_world_size_1_rank_0.pt
[36m(TaskRunner pid=75125)[0m step:40 - global_seqlen/min:20665.000 - global_seqlen/max:20665.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:20665.000 - global_seqlen/balanced_max:20665.000 - global_seqlen/mean:20665.000 - actor/entropy_loss:0.361 - actor/pg_loss:-0.442 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.053 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.345 - actor/lr:0.000 - val/test_score/openai/gsm8k:0.453 - critic/score/mean:0.484 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.484 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.391 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.391 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:220.031 - response_length/max:459.000 - response_length/min:63.000 - response_length/clip_ratio:0.000 - prompt_length/mean:102.859 - prompt_length/max:170.000 - prompt_length/min:72.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:6.608 - timing_s/old_log_prob:2.358 - timing_s/adv:0.019 - timing_s/update_actor:10.310 - timing_s/testing:35.534 - timing_s/save_checkpoint:12.151 - timing_s/step:66.983 - timing_per_token_ms/gen:0.469 - timing_per_token_ms/update_actor:0.499 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:20665.000 - perf/time_per_step:66.983 - perf/throughput:308.510
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 40/1740 [17:07<16:23:53, 34.73s/it]
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:773: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:711: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(TaskRunner pid=75125)[0m step:41 - global_seqlen/min:21857.000 - global_seqlen/max:21857.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:21857.000 - global_seqlen/balanced_max:21857.000 - global_seqlen/mean:21857.000 - actor/entropy_loss:0.389 - actor/pg_loss:-0.396 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.781 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.445 - actor/lr:0.000 - critic/score/mean:0.391 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.391 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.377 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.377 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:235.328 - response_length/max:512.000 - response_length/min:104.000 - response_length/clip_ratio:0.016 - prompt_length/mean:106.188 - prompt_length/max:180.000 - prompt_length/min:75.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.164 - timing_s/old_log_prob:2.358 - timing_s/adv:0.019 - timing_s/update_actor:10.500 - timing_s/step:20.044 - timing_per_token_ms/gen:0.476 - timing_per_token_ms/update_actor:0.480 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:21857.000 - perf/time_per_step:20.044 - perf/throughput:1090.449
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 41/1740 [17:27<14:18:40, 30.32s/it]
[36m(TaskRunner pid=75125)[0m step:42 - global_seqlen/min:20111.000 - global_seqlen/max:20111.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:20111.000 - global_seqlen/balanced_max:20111.000 - global_seqlen/mean:20111.000 - actor/entropy_loss:0.300 - actor/pg_loss:-0.381 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.182 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.363 - actor/lr:0.000 - critic/score/mean:0.438 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.438 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.350 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.350 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:207.406 - response_length/max:512.000 - response_length/min:75.000 - response_length/clip_ratio:0.016 - prompt_length/mean:106.828 - prompt_length/max:183.000 - prompt_length/min:73.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.291 - timing_s/old_log_prob:2.357 - timing_s/adv:0.019 - timing_s/update_actor:10.281 - timing_s/step:19.952 - timing_per_token_ms/gen:0.549 - timing_per_token_ms/update_actor:0.511 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:20111.000 - perf/time_per_step:19.952 - perf/throughput:1007.985
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 42/1740 [17:47<12:50:08, 27.21s/it]
[36m(TaskRunner pid=75125)[0m step:43 - global_seqlen/min:19747.000 - global_seqlen/max:19747.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:19747.000 - global_seqlen/balanced_max:19747.000 - global_seqlen/mean:19747.000 - actor/entropy_loss:0.324 - actor/pg_loss:-0.468 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.389 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.360 - actor/lr:0.000 - critic/score/mean:0.500 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.500 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.401 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.401 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:204.188 - response_length/max:512.000 - response_length/min:39.000 - response_length/clip_ratio:0.016 - prompt_length/mean:104.359 - prompt_length/max:175.000 - prompt_length/min:75.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.362 - timing_s/old_log_prob:2.363 - timing_s/adv:0.019 - timing_s/update_actor:10.566 - timing_s/step:20.313 - timing_per_token_ms/gen:0.563 - timing_per_token_ms/update_actor:0.535 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:19747.000 - perf/time_per_step:20.313 - perf/throughput:972.145
[36m(TaskRunner pid=75125)[0m Training Progress:   2%|▏         | 43/1740 [18:07<11:51:09, 25.14s/it]
[36m(TaskRunner pid=75125)[0m step:44 - global_seqlen/min:18738.000 - global_seqlen/max:18738.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18738.000 - global_seqlen/balanced_max:18738.000 - global_seqlen/mean:18738.000 - actor/entropy_loss:0.302 - actor/pg_loss:-0.526 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.307 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.367 - actor/lr:0.000 - critic/score/mean:0.562 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.562 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.481 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.481 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:192.516 - response_length/max:512.000 - response_length/min:71.000 - response_length/clip_ratio:0.016 - prompt_length/mean:100.266 - prompt_length/max:150.000 - prompt_length/min:72.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.307 - timing_s/old_log_prob:2.360 - timing_s/adv:0.019 - timing_s/update_actor:10.554 - timing_s/step:20.242 - timing_per_token_ms/gen:0.593 - timing_per_token_ms/update_actor:0.563 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18738.000 - perf/time_per_step:20.242 - perf/throughput:925.692
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 44/1740 [18:27<11:09:12, 23.67s/it]
[36m(TaskRunner pid=75125)[0m step:45 - global_seqlen/min:20860.000 - global_seqlen/max:20860.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:20860.000 - global_seqlen/balanced_max:20860.000 - global_seqlen/mean:20860.000 - actor/entropy_loss:0.383 - actor/pg_loss:-0.470 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.350 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.356 - actor/lr:0.000 - critic/score/mean:0.516 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.516 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.435 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.435 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:219.281 - response_length/max:512.000 - response_length/min:36.000 - response_length/clip_ratio:0.062 - prompt_length/mean:106.656 - prompt_length/max:196.000 - prompt_length/min:68.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.436 - timing_s/old_log_prob:2.366 - timing_s/adv:0.019 - timing_s/update_actor:10.570 - timing_s/step:20.393 - timing_per_token_ms/gen:0.530 - timing_per_token_ms/update_actor:0.507 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:20860.000 - perf/time_per_step:20.393 - perf/throughput:1022.885
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 45/1740 [18:48<10:41:01, 22.69s/it]
[36m(TaskRunner pid=75125)[0m step:46 - global_seqlen/min:18253.000 - global_seqlen/max:18253.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18253.000 - global_seqlen/balanced_max:18253.000 - global_seqlen/mean:18253.000 - actor/entropy_loss:0.306 - actor/pg_loss:-0.557 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.641 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.365 - actor/lr:0.000 - critic/score/mean:0.578 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.578 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.532 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.532 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:185.828 - response_length/max:449.000 - response_length/min:36.000 - response_length/clip_ratio:0.000 - prompt_length/mean:99.375 - prompt_length/max:150.000 - prompt_length/min:70.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:6.391 - timing_s/old_log_prob:2.354 - timing_s/adv:0.019 - timing_s/update_actor:10.504 - timing_s/step:19.270 - timing_per_token_ms/gen:0.537 - timing_per_token_ms/update_actor:0.575 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18253.000 - perf/time_per_step:19.270 - perf/throughput:947.200
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 46/1740 [19:07<10:11:43, 21.67s/it]
[36m(TaskRunner pid=75125)[0m step:47 - global_seqlen/min:18367.000 - global_seqlen/max:18367.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18367.000 - global_seqlen/balanced_max:18367.000 - global_seqlen/mean:18367.000 - actor/entropy_loss:0.251 - actor/pg_loss:-0.483 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.064 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.366 - actor/lr:0.000 - critic/score/mean:0.531 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.531 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.474 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.474 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:183.391 - response_length/max:396.000 - response_length/min:90.000 - response_length/clip_ratio:0.000 - prompt_length/mean:103.594 - prompt_length/max:163.000 - prompt_length/min:69.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.804 - timing_s/old_log_prob:2.359 - timing_s/adv:0.019 - timing_s/update_actor:10.561 - timing_s/step:18.746 - timing_per_token_ms/gen:0.494 - timing_per_token_ms/update_actor:0.575 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18367.000 - perf/time_per_step:18.746 - perf/throughput:979.782
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 47/1740 [19:26<9:46:39, 20.79s/it] 
[36m(TaskRunner pid=75125)[0m step:48 - global_seqlen/min:18286.000 - global_seqlen/max:18286.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18286.000 - global_seqlen/balanced_max:18286.000 - global_seqlen/mean:18286.000 - actor/entropy_loss:0.230 - actor/pg_loss:-0.510 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.865 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.371 - actor/lr:0.000 - critic/score/mean:0.516 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.516 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.472 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.472 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:181.953 - response_length/max:338.000 - response_length/min:65.000 - response_length/clip_ratio:0.000 - prompt_length/mean:103.766 - prompt_length/max:170.000 - prompt_length/min:69.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.131 - timing_s/old_log_prob:2.365 - timing_s/adv:0.019 - timing_s/update_actor:10.553 - timing_s/step:18.070 - timing_per_token_ms/gen:0.441 - timing_per_token_ms/update_actor:0.577 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18286.000 - perf/time_per_step:18.070 - perf/throughput:1011.929
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 48/1740 [19:44<9:23:19, 19.98s/it]
[36m(TaskRunner pid=75125)[0m step:49 - global_seqlen/min:18109.000 - global_seqlen/max:18109.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18109.000 - global_seqlen/balanced_max:18109.000 - global_seqlen/mean:18109.000 - actor/entropy_loss:0.238 - actor/pg_loss:-0.514 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.893 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.366 - actor/lr:0.000 - critic/score/mean:0.547 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.547 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.488 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.488 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:178.859 - response_length/max:367.000 - response_length/min:41.000 - response_length/clip_ratio:0.000 - prompt_length/mean:104.094 - prompt_length/max:169.000 - prompt_length/min:73.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.503 - timing_s/old_log_prob:2.365 - timing_s/adv:0.018 - timing_s/update_actor:10.548 - timing_s/step:18.437 - timing_per_token_ms/gen:0.481 - timing_per_token_ms/update_actor:0.582 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18109.000 - perf/time_per_step:18.437 - perf/throughput:982.225
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 49/1740 [20:02<9:10:02, 19.52s/it]
[36m(TaskRunner pid=75125)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=75125)[0m validation generation end
[36m(TaskRunner pid=75125)[0m [prompt] system
[36m(TaskRunner pid=75125)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=75125)[0m user
[36m(TaskRunner pid=75125)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=75125)[0m assistant
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m [response] First, we calculate the total number of eggs laid by the ducks in a day. Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Next, we account for the eggs Janet eats for breakfast and the muffins she bakes. She eats 3 eggs for breakfast and bakes 4 muffins, so the total number of eggs she eats in a day is:
[36m(TaskRunner pid=75125)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m The number of eggs Janet sells at the farmers' market is the total number of eggs laid minus the number of eggs she eats:
[36m(TaskRunner pid=75125)[0m \[ 16 - 7 = 9 \text{ eggs} \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Since she sells each egg for $2, the total amount of money she makes every day is:
[36m(TaskRunner pid=75125)[0m \[ 9 \times 2 = 18 \text{ dollars} \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Therefore, the final answer is:
[36m(TaskRunner pid=75125)[0m #### 18
[36m(TaskRunner pid=75125)[0m #### 18
[36m(TaskRunner pid=75125)[0m [ground_truth] 18
[36m(TaskRunner pid=75125)[0m [score] 1.0
[36m(TaskRunner pid=75125)[0m local_global_step_folder: checkpoints/verl_examples/gsm8k/global_step_50
[36m(TaskRunner pid=75125)[0m Warning: remove_previous_ckpt_in_save is deprecated, set max_actor_ckpt_to_keep=1 and max_critic_ckpt_to_keep=1 instead
[36m(WorkerDict pid=75383)[0m Checkpoint manager remove previous save local path: /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_40/actor
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving model to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_50/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving checkpoint to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_50/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving extra_state to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_50/actor/extra_state_world_size_1_rank_0.pt
[36m(TaskRunner pid=75125)[0m step:50 - global_seqlen/min:19423.000 - global_seqlen/max:19423.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:19423.000 - global_seqlen/balanced_max:19423.000 - global_seqlen/mean:19423.000 - actor/entropy_loss:0.236 - actor/pg_loss:-0.422 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.275 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:14.616 - perf/max_memory_reserved_gb:17.396 - perf/cpu_memory_used_gb:5.370 - actor/lr:0.000 - val/test_score/openai/gsm8k:0.484 - critic/score/mean:0.453 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.453 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.372 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.372 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:198.453 - response_length/max:512.000 - response_length/min:91.000 - response_length/clip_ratio:0.031 - prompt_length/mean:105.031 - prompt_length/max:189.000 - prompt_length/min:70.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.387 - timing_s/old_log_prob:2.359 - timing_s/adv:0.019 - timing_s/update_actor:10.561 - timing_s/testing:32.913 - timing_s/save_checkpoint:12.150 - timing_s/step:65.392 - timing_per_token_ms/gen:0.582 - timing_per_token_ms/update_actor:0.544 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:19423.000 - perf/time_per_step:65.392 - perf/throughput:297.024
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 50/1740 [21:07<15:37:23, 33.28s/it]
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:773: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:711: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(TaskRunner pid=75125)[0m step:51 - global_seqlen/min:18912.000 - global_seqlen/max:18912.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18912.000 - global_seqlen/balanced_max:18912.000 - global_seqlen/mean:18912.000 - actor/entropy_loss:0.246 - actor/pg_loss:-0.518 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.482 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.421 - actor/lr:0.000 - critic/score/mean:0.547 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.547 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.498 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.498 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:195.656 - response_length/max:512.000 - response_length/min:76.000 - response_length/clip_ratio:0.016 - prompt_length/mean:99.844 - prompt_length/max:172.000 - prompt_length/min:68.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.059 - timing_s/old_log_prob:2.365 - timing_s/adv:0.019 - timing_s/update_actor:10.262 - timing_s/step:19.708 - timing_per_token_ms/gen:0.564 - timing_per_token_ms/update_actor:0.543 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18912.000 - perf/time_per_step:19.708 - perf/throughput:959.611
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 51/1740 [21:27<13:42:14, 29.21s/it]
[36m(TaskRunner pid=75125)[0m step:52 - global_seqlen/min:19292.000 - global_seqlen/max:19292.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:19292.000 - global_seqlen/balanced_max:19292.000 - global_seqlen/mean:19292.000 - actor/entropy_loss:0.288 - actor/pg_loss:-0.450 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.201 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.378 - actor/lr:0.000 - critic/score/mean:0.484 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.484 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.393 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.393 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:191.641 - response_length/max:512.000 - response_length/min:78.000 - response_length/clip_ratio:0.016 - prompt_length/mean:109.797 - prompt_length/max:174.000 - prompt_length/min:72.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.362 - timing_s/old_log_prob:2.358 - timing_s/adv:0.019 - timing_s/update_actor:10.614 - timing_s/step:20.356 - timing_per_token_ms/gen:0.600 - timing_per_token_ms/update_actor:0.550 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:19292.000 - perf/time_per_step:20.356 - perf/throughput:947.728
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 52/1740 [21:48<12:27:04, 26.55s/it]
[36m(TaskRunner pid=75125)[0m step:53 - global_seqlen/min:18573.000 - global_seqlen/max:18573.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18573.000 - global_seqlen/balanced_max:18573.000 - global_seqlen/mean:18573.000 - actor/entropy_loss:0.291 - actor/pg_loss:-0.521 - actor/pg_clipfrac:0.003 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.054 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.379 - actor/lr:0.000 - critic/score/mean:0.531 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.531 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.473 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.473 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:186.422 - response_length/max:476.000 - response_length/min:56.000 - response_length/clip_ratio:0.000 - prompt_length/mean:103.781 - prompt_length/max:164.000 - prompt_length/min:66.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:6.844 - timing_s/old_log_prob:2.357 - timing_s/adv:0.018 - timing_s/update_actor:10.681 - timing_s/step:19.903 - timing_per_token_ms/gen:0.574 - timing_per_token_ms/update_actor:0.575 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18573.000 - perf/time_per_step:19.903 - perf/throughput:933.153
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 53/1740 [22:07<11:30:33, 24.56s/it]
[36m(TaskRunner pid=75125)[0m step:54 - global_seqlen/min:18142.000 - global_seqlen/max:18142.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18142.000 - global_seqlen/balanced_max:18142.000 - global_seqlen/mean:18142.000 - actor/entropy_loss:0.219 - actor/pg_loss:-0.580 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.284 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.377 - actor/lr:0.000 - critic/score/mean:0.594 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.594 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.491 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.491 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:180.453 - response_length/max:512.000 - response_length/min:70.000 - response_length/clip_ratio:0.016 - prompt_length/mean:103.016 - prompt_length/max:173.000 - prompt_length/min:75.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.187 - timing_s/old_log_prob:2.367 - timing_s/adv:0.018 - timing_s/update_actor:10.616 - timing_s/step:20.192 - timing_per_token_ms/gen:0.622 - timing_per_token_ms/update_actor:0.585 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18142.000 - perf/time_per_step:20.192 - perf/throughput:898.492
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 54/1740 [22:28<10:53:22, 23.25s/it]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m step:55 - global_seqlen/min:17982.000 - global_seqlen/max:17982.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:17982.000 - global_seqlen/balanced_max:17982.000 - global_seqlen/mean:17982.000 - actor/entropy_loss:0.215 - actor/pg_loss:-0.595 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.368 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.380 - actor/lr:0.000 - critic/score/mean:0.594 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.594 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.559 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.559 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:178.312 - response_length/max:435.000 - response_length/min:53.000 - response_length/clip_ratio:0.000 - prompt_length/mean:102.656 - prompt_length/max:158.000 - prompt_length/min:68.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:6.290 - timing_s/old_log_prob:2.363 - timing_s/adv:0.019 - timing_s/update_actor:10.573 - timing_s/step:19.247 - timing_per_token_ms/gen:0.551 - timing_per_token_ms/update_actor:0.588 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:17982.000 - perf/time_per_step:19.247 - perf/throughput:934.253
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 55/1740 [22:47<10:19:16, 22.05s/it]
[36m(TaskRunner pid=75125)[0m step:56 - global_seqlen/min:18441.000 - global_seqlen/max:18441.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18441.000 - global_seqlen/balanced_max:18441.000 - global_seqlen/mean:18441.000 - actor/entropy_loss:0.213 - actor/pg_loss:-0.638 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.387 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.380 - actor/lr:0.000 - critic/score/mean:0.672 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.672 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.612 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.612 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:183.625 - response_length/max:471.000 - response_length/min:64.000 - response_length/clip_ratio:0.000 - prompt_length/mean:104.516 - prompt_length/max:199.000 - prompt_length/min:65.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:6.700 - timing_s/old_log_prob:2.364 - timing_s/adv:0.019 - timing_s/update_actor:10.666 - timing_s/step:19.751 - timing_per_token_ms/gen:0.570 - timing_per_token_ms/update_actor:0.578 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18441.000 - perf/time_per_step:19.751 - perf/throughput:933.670
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 56/1740 [23:07<9:59:33, 21.36s/it] 
[36m(TaskRunner pid=75125)[0m step:57 - global_seqlen/min:18923.000 - global_seqlen/max:18923.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18923.000 - global_seqlen/balanced_max:18923.000 - global_seqlen/mean:18923.000 - actor/entropy_loss:0.222 - actor/pg_loss:-0.428 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.680 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.372 - actor/lr:0.000 - critic/score/mean:0.469 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.469 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.397 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.397 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:193.484 - response_length/max:512.000 - response_length/min:13.000 - response_length/clip_ratio:0.031 - prompt_length/mean:102.188 - prompt_length/max:157.000 - prompt_length/min:72.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.329 - timing_s/old_log_prob:2.357 - timing_s/adv:0.019 - timing_s/update_actor:10.399 - timing_s/step:20.106 - timing_per_token_ms/gen:0.592 - timing_per_token_ms/update_actor:0.550 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18923.000 - perf/time_per_step:20.106 - perf/throughput:941.159
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 57/1740 [23:27<9:48:43, 20.99s/it]
[36m(TaskRunner pid=75125)[0m step:58 - global_seqlen/min:17545.000 - global_seqlen/max:17545.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:17545.000 - global_seqlen/balanced_max:17545.000 - global_seqlen/mean:17545.000 - actor/entropy_loss:0.199 - actor/pg_loss:-0.485 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.824 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.375 - actor/lr:0.000 - critic/score/mean:0.500 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.500 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.416 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.416 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:171.953 - response_length/max:416.000 - response_length/min:76.000 - response_length/clip_ratio:0.000 - prompt_length/mean:102.188 - prompt_length/max:147.000 - prompt_length/min:72.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:6.004 - timing_s/old_log_prob:2.362 - timing_s/adv:0.018 - timing_s/update_actor:10.155 - timing_s/step:18.541 - timing_per_token_ms/gen:0.546 - timing_per_token_ms/update_actor:0.579 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:17545.000 - perf/time_per_step:18.541 - perf/throughput:946.288
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 58/1740 [23:45<9:27:48, 20.25s/it]
[36m(TaskRunner pid=75125)[0m step:59 - global_seqlen/min:18666.000 - global_seqlen/max:18666.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18666.000 - global_seqlen/balanced_max:18666.000 - global_seqlen/mean:18666.000 - actor/entropy_loss:0.210 - actor/pg_loss:-0.553 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.100 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.377 - actor/lr:0.000 - critic/score/mean:0.562 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.562 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.522 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.522 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:187.234 - response_length/max:499.000 - response_length/min:75.000 - response_length/clip_ratio:0.000 - prompt_length/mean:104.422 - prompt_length/max:160.000 - prompt_length/min:72.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.202 - timing_s/old_log_prob:2.358 - timing_s/adv:0.019 - timing_s/update_actor:10.149 - timing_s/step:19.730 - timing_per_token_ms/gen:0.601 - timing_per_token_ms/update_actor:0.544 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18666.000 - perf/time_per_step:19.730 - perf/throughput:946.059
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 59/1740 [24:05<9:23:05, 20.10s/it]
[36m(TaskRunner pid=75125)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=75125)[0m validation generation end
[36m(TaskRunner pid=75125)[0m [prompt] system
[36m(TaskRunner pid=75125)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=75125)[0m user
[36m(TaskRunner pid=75125)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=75125)[0m assistant
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m [response] First, we need to calculate the total number of eggs laid by the ducks in a day. Janet's ducks lay 16 eggs per day.
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Next, we need to account for the eggs Janet eats for breakfast and the muffins she bakes. She eats 3 eggs for breakfast and bakes 4 muffins, so the total number of eggs eaten is:
[36m(TaskRunner pid=75125)[0m \[ 3 + 4 = 7 \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Therefore, the number of eggs Janet sells is:
[36m(TaskRunner pid=75125)[0m \[ 16 - 7 = 9 \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Since she sells each egg for $2, the total amount of money she makes every day is:
[36m(TaskRunner pid=75125)[0m \[ 9 \times 2 = 18 \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m So, the final answer is:
[36m(TaskRunner pid=75125)[0m #### 18
[36m(TaskRunner pid=75125)[0m #### 18
[36m(TaskRunner pid=75125)[0m [ground_truth] 18
[36m(TaskRunner pid=75125)[0m [score] 1.0
[36m(TaskRunner pid=75125)[0m local_global_step_folder: checkpoints/verl_examples/gsm8k/global_step_60
[36m(TaskRunner pid=75125)[0m Warning: remove_previous_ckpt_in_save is deprecated, set max_actor_ckpt_to_keep=1 and max_critic_ckpt_to_keep=1 instead
[36m(WorkerDict pid=75383)[0m Checkpoint manager remove previous save local path: /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_50/actor
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving model to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_60/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving checkpoint to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_60/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving extra_state to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_60/actor/extra_state_world_size_1_rank_0.pt
[36m(TaskRunner pid=75125)[0m step:60 - global_seqlen/min:18281.000 - global_seqlen/max:18281.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18281.000 - global_seqlen/balanced_max:18281.000 - global_seqlen/mean:18281.000 - actor/entropy_loss:0.166 - actor/pg_loss:-0.558 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.951 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.362 - actor/lr:0.000 - val/test_score/openai/gsm8k:0.464 - critic/score/mean:0.562 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.562 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.519 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.519 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:184.078 - response_length/max:392.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:101.562 - prompt_length/max:152.000 - prompt_length/min:70.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.732 - timing_s/old_log_prob:2.362 - timing_s/adv:0.019 - timing_s/update_actor:10.561 - timing_s/testing:32.486 - timing_s/save_checkpoint:12.104 - timing_s/step:63.267 - timing_per_token_ms/gen:0.487 - timing_per_token_ms/update_actor:0.578 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18281.000 - perf/time_per_step:63.267 - perf/throughput:288.949
[36m(TaskRunner pid=75125)[0m Training Progress:   3%|▎         | 60/1740 [25:08<15:25:24, 33.05s/it]
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:773: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:711: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(TaskRunner pid=75125)[0m step:61 - global_seqlen/min:18635.000 - global_seqlen/max:18635.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18635.000 - global_seqlen/balanced_max:18635.000 - global_seqlen/mean:18635.000 - actor/entropy_loss:0.165 - actor/pg_loss:-0.440 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.283 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.379 - actor/lr:0.000 - critic/score/mean:0.469 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.469 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.421 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.421 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:183.859 - response_length/max:361.000 - response_length/min:84.000 - response_length/clip_ratio:0.000 - prompt_length/mean:107.312 - prompt_length/max:238.000 - prompt_length/min:72.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.383 - timing_s/old_log_prob:2.364 - timing_s/adv:0.019 - timing_s/update_actor:10.564 - timing_s/step:18.334 - timing_per_token_ms/gen:0.457 - timing_per_token_ms/update_actor:0.567 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18635.000 - perf/time_per_step:18.334 - perf/throughput:1016.408
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▎         | 61/1740 [25:27<13:21:20, 28.64s/it]
[36m(TaskRunner pid=75125)[0m step:62 - global_seqlen/min:17311.000 - global_seqlen/max:17311.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:17311.000 - global_seqlen/balanced_max:17311.000 - global_seqlen/mean:17311.000 - actor/entropy_loss:0.197 - actor/pg_loss:-0.494 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.742 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.367 - actor/lr:0.000 - critic/score/mean:0.516 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.516 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.457 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.457 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:169.250 - response_length/max:380.000 - response_length/min:10.000 - response_length/clip_ratio:0.000 - prompt_length/mean:101.234 - prompt_length/max:163.000 - prompt_length/min:70.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.578 - timing_s/old_log_prob:2.363 - timing_s/adv:0.019 - timing_s/update_actor:10.554 - timing_s/step:18.516 - timing_per_token_ms/gen:0.515 - timing_per_token_ms/update_actor:0.610 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:17311.000 - perf/time_per_step:18.516 - perf/throughput:934.928
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▎         | 62/1740 [25:45<11:56:00, 25.60s/it]
[36m(TaskRunner pid=75125)[0m step:63 - global_seqlen/min:17486.000 - global_seqlen/max:17486.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:17486.000 - global_seqlen/balanced_max:17486.000 - global_seqlen/mean:17486.000 - actor/entropy_loss:0.149 - actor/pg_loss:-0.554 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.366 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.371 - actor/lr:0.000 - critic/score/mean:0.578 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.578 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.531 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.531 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:173.281 - response_length/max:417.000 - response_length/min:55.000 - response_length/clip_ratio:0.000 - prompt_length/mean:99.938 - prompt_length/max:164.000 - prompt_length/min:56.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.986 - timing_s/old_log_prob:2.360 - timing_s/adv:0.018 - timing_s/update_actor:10.403 - timing_s/step:18.769 - timing_per_token_ms/gen:0.540 - timing_per_token_ms/update_actor:0.595 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:17486.000 - perf/time_per_step:18.769 - perf/throughput:931.618
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▎         | 63/1740 [26:04<10:58:18, 23.55s/it]
[36m(TaskRunner pid=75125)[0m step:64 - global_seqlen/min:18451.000 - global_seqlen/max:18451.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18451.000 - global_seqlen/balanced_max:18451.000 - global_seqlen/mean:18451.000 - actor/entropy_loss:0.172 - actor/pg_loss:-0.412 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:4.256 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.368 - actor/lr:0.000 - critic/score/mean:0.438 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.438 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.383 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.383 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:180.797 - response_length/max:358.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:107.500 - prompt_length/max:178.000 - prompt_length/min:70.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.252 - timing_s/old_log_prob:2.354 - timing_s/adv:0.019 - timing_s/update_actor:10.578 - timing_s/step:18.206 - timing_per_token_ms/gen:0.454 - timing_per_token_ms/update_actor:0.573 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18451.000 - perf/time_per_step:18.206 - perf/throughput:1013.439
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▎         | 64/1740 [26:22<10:13:08, 21.95s/it]
[36m(TaskRunner pid=75125)[0m step:65 - global_seqlen/min:19148.000 - global_seqlen/max:19148.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:19148.000 - global_seqlen/balanced_max:19148.000 - global_seqlen/mean:19148.000 - actor/entropy_loss:0.143 - actor/pg_loss:-0.509 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.314 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.355 - actor/lr:0.000 - critic/score/mean:0.531 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.531 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.482 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.482 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:190.781 - response_length/max:512.000 - response_length/min:100.000 - response_length/clip_ratio:0.016 - prompt_length/mean:108.406 - prompt_length/max:183.000 - prompt_length/min:75.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.274 - timing_s/old_log_prob:2.360 - timing_s/adv:0.019 - timing_s/update_actor:10.598 - timing_s/step:20.254 - timing_per_token_ms/gen:0.596 - timing_per_token_ms/update_actor:0.553 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:19148.000 - perf/time_per_step:20.254 - perf/throughput:945.404
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▎         | 65/1740 [26:42<9:58:35, 21.44s/it] 
[36m(TaskRunner pid=75125)[0m step:66 - global_seqlen/min:19484.000 - global_seqlen/max:19484.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:19484.000 - global_seqlen/balanced_max:19484.000 - global_seqlen/mean:19484.000 - actor/entropy_loss:0.191 - actor/pg_loss:-0.440 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.292 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.363 - actor/lr:0.000 - critic/score/mean:0.469 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.469 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.418 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.418 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:200.172 - response_length/max:504.000 - response_length/min:21.000 - response_length/clip_ratio:0.000 - prompt_length/mean:104.266 - prompt_length/max:193.000 - prompt_length/min:71.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.278 - timing_s/old_log_prob:2.363 - timing_s/adv:0.019 - timing_s/update_actor:10.591 - timing_s/step:20.253 - timing_per_token_ms/gen:0.568 - timing_per_token_ms/update_actor:0.544 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:19484.000 - perf/time_per_step:20.253 - perf/throughput:962.011
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▍         | 66/1740 [27:03<9:48:18, 21.09s/it]
[36m(TaskRunner pid=75125)[0m step:67 - global_seqlen/min:17961.000 - global_seqlen/max:17961.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:17961.000 - global_seqlen/balanced_max:17961.000 - global_seqlen/mean:17961.000 - actor/entropy_loss:0.153 - actor/pg_loss:-0.557 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.894 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.367 - actor/lr:0.000 - critic/score/mean:0.578 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.578 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.519 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.519 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:178.453 - response_length/max:390.000 - response_length/min:77.000 - response_length/clip_ratio:0.000 - prompt_length/mean:102.188 - prompt_length/max:170.000 - prompt_length/min:62.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.703 - timing_s/old_log_prob:2.363 - timing_s/adv:0.018 - timing_s/update_actor:10.428 - timing_s/step:18.516 - timing_per_token_ms/gen:0.499 - timing_per_token_ms/update_actor:0.581 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:17961.000 - perf/time_per_step:18.516 - perf/throughput:970.019
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▍         | 67/1740 [27:21<9:26:31, 20.32s/it]
[36m(TaskRunner pid=75125)[0m step:68 - global_seqlen/min:18235.000 - global_seqlen/max:18235.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18235.000 - global_seqlen/balanced_max:18235.000 - global_seqlen/mean:18235.000 - actor/entropy_loss:0.130 - actor/pg_loss:-0.555 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.040 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.376 - actor/lr:0.000 - critic/score/mean:0.562 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.562 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.512 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.512 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:181.188 - response_length/max:501.000 - response_length/min:68.000 - response_length/clip_ratio:0.000 - prompt_length/mean:103.734 - prompt_length/max:163.000 - prompt_length/min:75.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.224 - timing_s/old_log_prob:2.365 - timing_s/adv:0.019 - timing_s/update_actor:10.660 - timing_s/step:20.271 - timing_per_token_ms/gen:0.623 - timing_per_token_ms/update_actor:0.585 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18235.000 - perf/time_per_step:20.271 - perf/throughput:899.557
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▍         | 68/1740 [27:41<9:25:50, 20.31s/it]
[36m(TaskRunner pid=75125)[0m step:69 - global_seqlen/min:17534.000 - global_seqlen/max:17534.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:17534.000 - global_seqlen/balanced_max:17534.000 - global_seqlen/mean:17534.000 - actor/entropy_loss:0.126 - actor/pg_loss:-0.665 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.576 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.376 - actor/lr:0.000 - critic/score/mean:0.688 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.688 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.639 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.639 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:175.281 - response_length/max:512.000 - response_length/min:60.000 - response_length/clip_ratio:0.016 - prompt_length/mean:98.688 - prompt_length/max:167.000 - prompt_length/min:69.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.065 - timing_s/old_log_prob:2.366 - timing_s/adv:0.018 - timing_s/update_actor:10.245 - timing_s/step:19.697 - timing_per_token_ms/gen:0.630 - timing_per_token_ms/update_actor:0.584 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:17534.000 - perf/time_per_step:19.697 - perf/throughput:890.174
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▍         | 69/1740 [28:01<9:20:26, 20.12s/it]
[36m(TaskRunner pid=75125)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=75125)[0m validation generation end
[36m(TaskRunner pid=75125)[0m [prompt] system
[36m(TaskRunner pid=75125)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=75125)[0m user
[36m(TaskRunner pid=75125)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=75125)[0m assistant
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m [response] First, we need to calculate the total number of eggs laid by the ducks in a day. Since Janet's ducks lay 16 eggs per day, the number of eggs eaten in a day is 16, and the number of eggs baked is 4. Therefore, the number of eggs sold is:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m \[ 16 - 4 = 12 \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m So, Janet sells 12 eggs daily. Since each egg is sold for $2, the total earnings per day are:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m \[ 12 \times 2 = 24 \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Therefore, the amount of money Janet makes every day at the farmers' market is:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m #### 24
[36m(TaskRunner pid=75125)[0m #### 24
[36m(TaskRunner pid=75125)[0m [ground_truth] 18
[36m(TaskRunner pid=75125)[0m [score] 0.0
[36m(TaskRunner pid=75125)[0m local_global_step_folder: checkpoints/verl_examples/gsm8k/global_step_70
[36m(TaskRunner pid=75125)[0m Warning: remove_previous_ckpt_in_save is deprecated, set max_actor_ckpt_to_keep=1 and max_critic_ckpt_to_keep=1 instead
[36m(TaskRunner pid=75125)[0m 
[36m(WorkerDict pid=75383)[0m Checkpoint manager remove previous save local path: /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_60/actor
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving model to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_70/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving checkpoint to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_70/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving extra_state to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_70/actor/extra_state_world_size_1_rank_0.pt
[36m(TaskRunner pid=75125)[0m step:70 - global_seqlen/min:18094.000 - global_seqlen/max:18094.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18094.000 - global_seqlen/balanced_max:18094.000 - global_seqlen/mean:18094.000 - actor/entropy_loss:0.135 - actor/pg_loss:-0.661 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.843 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.340 - actor/lr:0.000 - val/test_score/openai/gsm8k:0.480 - critic/score/mean:0.703 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.703 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.625 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.625 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:183.938 - response_length/max:512.000 - response_length/min:61.000 - response_length/clip_ratio:0.016 - prompt_length/mean:98.781 - prompt_length/max:160.000 - prompt_length/min:65.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.388 - timing_s/old_log_prob:2.360 - timing_s/adv:0.019 - timing_s/update_actor:10.489 - timing_s/testing:32.717 - timing_s/save_checkpoint:12.038 - timing_s/step:65.014 - timing_per_token_ms/gen:0.628 - timing_per_token_ms/update_actor:0.580 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18094.000 - perf/time_per_step:65.014 - perf/throughput:278.310
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▍         | 70/1740 [29:06<15:35:00, 33.59s/it]
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:773: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:711: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(TaskRunner pid=75125)[0m step:71 - global_seqlen/min:18480.000 - global_seqlen/max:18480.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18480.000 - global_seqlen/balanced_max:18480.000 - global_seqlen/mean:18480.000 - actor/entropy_loss:0.132 - actor/pg_loss:-0.558 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.519 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.428 - actor/lr:0.000 - critic/score/mean:0.609 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.609 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.529 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.529 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:179.469 - response_length/max:392.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:109.281 - prompt_length/max:182.000 - prompt_length/min:77.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.685 - timing_s/old_log_prob:2.364 - timing_s/adv:0.019 - timing_s/update_actor:10.420 - timing_s/step:18.490 - timing_per_token_ms/gen:0.495 - timing_per_token_ms/update_actor:0.564 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18480.000 - perf/time_per_step:18.490 - perf/throughput:999.439
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▍         | 71/1740 [29:25<13:28:26, 29.06s/it]
[36m(TaskRunner pid=75125)[0m step:72 - global_seqlen/min:18551.000 - global_seqlen/max:18551.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18551.000 - global_seqlen/balanced_max:18551.000 - global_seqlen/mean:18551.000 - actor/entropy_loss:0.167 - actor/pg_loss:-0.622 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:4.085 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.395 - actor/lr:0.000 - critic/score/mean:0.641 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.641 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.585 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.585 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:188.219 - response_length/max:512.000 - response_length/min:57.000 - response_length/clip_ratio:0.016 - prompt_length/mean:101.641 - prompt_length/max:211.000 - prompt_length/min:64.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.287 - timing_s/old_log_prob:2.363 - timing_s/adv:0.019 - timing_s/update_actor:10.338 - timing_s/step:20.010 - timing_per_token_ms/gen:0.605 - timing_per_token_ms/update_actor:0.557 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18551.000 - perf/time_per_step:20.010 - perf/throughput:927.097
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▍         | 72/1740 [29:45<12:12:28, 26.35s/it]
[36m(TaskRunner pid=75125)[0m step:73 - global_seqlen/min:18850.000 - global_seqlen/max:18850.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18850.000 - global_seqlen/balanced_max:18850.000 - global_seqlen/mean:18850.000 - actor/entropy_loss:0.135 - actor/pg_loss:-0.597 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.494 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.379 - actor/lr:0.000 - critic/score/mean:0.594 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.594 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.547 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.547 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:186.672 - response_length/max:405.000 - response_length/min:28.000 - response_length/clip_ratio:0.000 - prompt_length/mean:107.859 - prompt_length/max:179.000 - prompt_length/min:70.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.975 - timing_s/old_log_prob:2.355 - timing_s/adv:0.019 - timing_s/update_actor:10.803 - timing_s/step:19.156 - timing_per_token_ms/gen:0.500 - timing_per_token_ms/update_actor:0.573 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18850.000 - perf/time_per_step:19.156 - perf/throughput:984.051
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▍         | 73/1740 [30:04<11:12:06, 24.19s/it]
[36m(TaskRunner pid=75125)[0m step:74 - global_seqlen/min:18450.000 - global_seqlen/max:18450.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18450.000 - global_seqlen/balanced_max:18450.000 - global_seqlen/mean:18450.000 - actor/entropy_loss:0.129 - actor/pg_loss:-0.532 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.512 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.384 - actor/lr:0.000 - critic/score/mean:0.562 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.562 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.465 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.465 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:181.547 - response_length/max:411.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:106.734 - prompt_length/max:173.000 - prompt_length/min:73.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.919 - timing_s/old_log_prob:2.364 - timing_s/adv:0.019 - timing_s/update_actor:10.370 - timing_s/step:18.673 - timing_per_token_ms/gen:0.509 - timing_per_token_ms/update_actor:0.562 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18450.000 - perf/time_per_step:18.673 - perf/throughput:988.035
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▍         | 74/1740 [30:23<10:25:45, 22.54s/it]
[36m(TaskRunner pid=75125)[0m step:75 - global_seqlen/min:19395.000 - global_seqlen/max:19395.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:19395.000 - global_seqlen/balanced_max:19395.000 - global_seqlen/mean:19395.000 - actor/entropy_loss:0.159 - actor/pg_loss:-0.555 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.177 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.379 - actor/lr:0.000 - critic/score/mean:0.578 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.578 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.509 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.509 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:200.438 - response_length/max:512.000 - response_length/min:46.000 - response_length/clip_ratio:0.016 - prompt_length/mean:102.609 - prompt_length/max:180.000 - prompt_length/min:74.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.158 - timing_s/old_log_prob:2.358 - timing_s/adv:0.019 - timing_s/update_actor:10.554 - timing_s/step:20.091 - timing_per_token_ms/gen:0.558 - timing_per_token_ms/update_actor:0.544 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:19395.000 - perf/time_per_step:20.091 - perf/throughput:965.348
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▍         | 75/1740 [30:43<10:05:06, 21.81s/it]
[36m(TaskRunner pid=75125)[0m step:76 - global_seqlen/min:20209.000 - global_seqlen/max:20209.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:20209.000 - global_seqlen/balanced_max:20209.000 - global_seqlen/mean:20209.000 - actor/entropy_loss:0.155 - actor/pg_loss:-0.503 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.185 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.377 - actor/lr:0.000 - critic/score/mean:0.547 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.547 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.469 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.469 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:210.609 - response_length/max:512.000 - response_length/min:50.000 - response_length/clip_ratio:0.016 - prompt_length/mean:105.156 - prompt_length/max:149.000 - prompt_length/min:72.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.287 - timing_s/old_log_prob:2.362 - timing_s/adv:0.019 - timing_s/update_actor:10.634 - timing_s/step:20.306 - timing_per_token_ms/gen:0.541 - timing_per_token_ms/update_actor:0.526 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:20209.000 - perf/time_per_step:20.306 - perf/throughput:995.223
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▍         | 76/1740 [31:03<9:52:18, 21.36s/it] 
[36m(TaskRunner pid=75125)[0m step:77 - global_seqlen/min:19187.000 - global_seqlen/max:19187.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:19187.000 - global_seqlen/balanced_max:19187.000 - global_seqlen/mean:19187.000 - actor/entropy_loss:0.144 - actor/pg_loss:-0.545 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.163 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.369 - actor/lr:0.000 - critic/score/mean:0.578 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.578 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.506 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.506 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:193.000 - response_length/max:512.000 - response_length/min:71.000 - response_length/clip_ratio:0.016 - prompt_length/mean:106.797 - prompt_length/max:181.000 - prompt_length/min:74.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.219 - timing_s/old_log_prob:2.356 - timing_s/adv:0.019 - timing_s/update_actor:10.371 - timing_s/step:19.967 - timing_per_token_ms/gen:0.584 - timing_per_token_ms/update_actor:0.541 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:19187.000 - perf/time_per_step:19.967 - perf/throughput:960.959
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▍         | 77/1740 [31:23<9:40:24, 20.94s/it]
[36m(TaskRunner pid=75125)[0m step:78 - global_seqlen/min:18875.000 - global_seqlen/max:18875.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18875.000 - global_seqlen/balanced_max:18875.000 - global_seqlen/mean:18875.000 - actor/entropy_loss:0.128 - actor/pg_loss:-0.530 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.432 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.367 - actor/lr:0.000 - critic/score/mean:0.578 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.578 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.475 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.475 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:193.609 - response_length/max:512.000 - response_length/min:65.000 - response_length/clip_ratio:0.016 - prompt_length/mean:101.312 - prompt_length/max:194.000 - prompt_length/min:64.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.476 - timing_s/old_log_prob:2.361 - timing_s/adv:0.018 - timing_s/update_actor:10.415 - timing_s/step:20.274 - timing_per_token_ms/gen:0.603 - timing_per_token_ms/update_actor:0.552 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18875.000 - perf/time_per_step:20.274 - perf/throughput:930.994
[36m(TaskRunner pid=75125)[0m Training Progress:   4%|▍         | 78/1740 [31:43<9:34:34, 20.74s/it]
[36m(TaskRunner pid=75125)[0m step:79 - global_seqlen/min:18369.000 - global_seqlen/max:18369.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18369.000 - global_seqlen/balanced_max:18369.000 - global_seqlen/mean:18369.000 - actor/entropy_loss:0.137 - actor/pg_loss:-0.525 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.264 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.369 - actor/lr:0.000 - critic/score/mean:0.516 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.516 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.477 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.477 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:182.578 - response_length/max:405.000 - response_length/min:66.000 - response_length/clip_ratio:0.000 - prompt_length/mean:104.438 - prompt_length/max:201.000 - prompt_length/min:70.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.871 - timing_s/old_log_prob:2.362 - timing_s/adv:0.018 - timing_s/update_actor:10.657 - timing_s/step:18.912 - timing_per_token_ms/gen:0.502 - timing_per_token_ms/update_actor:0.580 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18369.000 - perf/time_per_step:18.912 - perf/throughput:971.314
[36m(TaskRunner pid=75125)[0m Training Progress:   5%|▍         | 79/1740 [32:02<9:19:02, 20.19s/it]
[36m(TaskRunner pid=75125)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=75125)[0m validation generation end
[36m(TaskRunner pid=75125)[0m [prompt] system
[36m(TaskRunner pid=75125)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=75125)[0m user
[36m(TaskRunner pid=75125)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=75125)[0m assistant
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m [response] First, we need to calculate the total number of eggs laid by the ducks in a day. Since Janet's ducks lay 16 eggs per day, the number of eggs eaten in a day is 16, and the number of eggs baked is 4, so the number of eggs sold is:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m \[ 16 - 4 = 12 \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Next, we calculate the total revenue from selling the eggs. Since each egg is sold for $2, the revenue is:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m \[ 12 \times 2 = 24 \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Therefore, the amount of money Janet makes every day at the farmers' market is:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m #### 24
[36m(TaskRunner pid=75125)[0m #### 24
[36m(TaskRunner pid=75125)[0m [ground_truth] 18
[36m(TaskRunner pid=75125)[0m [score] 0.0
[36m(TaskRunner pid=75125)[0m local_global_step_folder: checkpoints/verl_examples/gsm8k/global_step_80
[36m(TaskRunner pid=75125)[0m Warning: remove_previous_ckpt_in_save is deprecated, set max_actor_ckpt_to_keep=1 and max_critic_ckpt_to_keep=1 instead
[36m(WorkerDict pid=75383)[0m Checkpoint manager remove previous save local path: /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_70/actor
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving model to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_80/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving checkpoint to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_80/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving extra_state to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_80/actor/extra_state_world_size_1_rank_0.pt
[36m(TaskRunner pid=75125)[0m step:80 - global_seqlen/min:18736.000 - global_seqlen/max:18736.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18736.000 - global_seqlen/balanced_max:18736.000 - global_seqlen/mean:18736.000 - actor/entropy_loss:0.109 - actor/pg_loss:-0.701 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:4.169 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.370 - actor/lr:0.000 - val/test_score/openai/gsm8k:0.484 - critic/score/mean:0.703 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.703 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.683 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.683 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:184.156 - response_length/max:304.000 - response_length/min:20.000 - response_length/clip_ratio:0.000 - prompt_length/mean:108.594 - prompt_length/max:175.000 - prompt_length/min:70.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:4.795 - timing_s/old_log_prob:2.363 - timing_s/adv:0.019 - timing_s/update_actor:10.347 - timing_s/testing:33.695 - timing_s/save_checkpoint:12.039 - timing_s/step:63.261 - timing_per_token_ms/gen:0.407 - timing_per_token_ms/update_actor:0.552 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18736.000 - perf/time_per_step:63.261 - perf/throughput:296.171
[36m(TaskRunner pid=75125)[0m Training Progress:   5%|▍         | 80/1740 [33:05<15:16:10, 33.11s/it]
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:773: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:711: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(TaskRunner pid=75125)[0m step:81 - global_seqlen/min:18346.000 - global_seqlen/max:18346.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18346.000 - global_seqlen/balanced_max:18346.000 - global_seqlen/mean:18346.000 - actor/entropy_loss:0.130 - actor/pg_loss:-0.566 - actor/pg_clipfrac:0.003 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:4.135 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.384 - actor/lr:0.000 - critic/score/mean:0.578 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.578 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.550 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.550 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:183.594 - response_length/max:512.000 - response_length/min:82.000 - response_length/clip_ratio:0.016 - prompt_length/mean:103.062 - prompt_length/max:148.000 - prompt_length/min:68.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.064 - timing_s/old_log_prob:2.361 - timing_s/adv:0.019 - timing_s/update_actor:10.647 - timing_s/step:20.093 - timing_per_token_ms/gen:0.601 - timing_per_token_ms/update_actor:0.580 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18346.000 - perf/time_per_step:20.093 - perf/throughput:913.052
[36m(TaskRunner pid=75125)[0m Training Progress:   5%|▍         | 81/1740 [33:25<13:27:41, 29.21s/it]
[36m(TaskRunner pid=75125)[0m step:82 - global_seqlen/min:18947.000 - global_seqlen/max:18947.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18947.000 - global_seqlen/balanced_max:18947.000 - global_seqlen/mean:18947.000 - actor/entropy_loss:0.136 - actor/pg_loss:-0.585 - actor/pg_clipfrac:0.003 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.332 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.381 - actor/lr:0.000 - critic/score/mean:0.641 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.641 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.599 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.599 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:194.797 - response_length/max:512.000 - response_length/min:44.000 - response_length/clip_ratio:0.016 - prompt_length/mean:101.250 - prompt_length/max:152.000 - prompt_length/min:68.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.287 - timing_s/old_log_prob:2.363 - timing_s/adv:0.019 - timing_s/update_actor:10.344 - timing_s/step:20.016 - timing_per_token_ms/gen:0.585 - timing_per_token_ms/update_actor:0.546 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18947.000 - perf/time_per_step:20.016 - perf/throughput:946.592
[36m(TaskRunner pid=75125)[0m Training Progress:   5%|▍         | 82/1740 [33:46<12:10:59, 26.45s/it]
[36m(TaskRunner pid=75125)[0m step:83 - global_seqlen/min:18442.000 - global_seqlen/max:18442.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18442.000 - global_seqlen/balanced_max:18442.000 - global_seqlen/mean:18442.000 - actor/entropy_loss:0.109 - actor/pg_loss:-0.472 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.510 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.376 - actor/lr:0.000 - critic/score/mean:0.484 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.484 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.434 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.434 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:184.734 - response_length/max:485.000 - response_length/min:39.000 - response_length/clip_ratio:0.000 - prompt_length/mean:103.422 - prompt_length/max:172.000 - prompt_length/min:72.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:6.939 - timing_s/old_log_prob:2.357 - timing_s/adv:0.019 - timing_s/update_actor:10.465 - timing_s/step:19.782 - timing_per_token_ms/gen:0.587 - timing_per_token_ms/update_actor:0.567 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18442.000 - perf/time_per_step:19.782 - perf/throughput:932.246
[36m(TaskRunner pid=75125)[0m Training Progress:   5%|▍         | 83/1740 [34:05<11:15:18, 24.45s/it]
[36m(TaskRunner pid=75125)[0m step:84 - global_seqlen/min:17826.000 - global_seqlen/max:17826.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:17826.000 - global_seqlen/balanced_max:17826.000 - global_seqlen/mean:17826.000 - actor/entropy_loss:0.117 - actor/pg_loss:-0.666 - actor/pg_clipfrac:0.005 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:4.264 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.382 - actor/lr:0.000 - critic/score/mean:0.688 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.688 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.615 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.615 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:180.125 - response_length/max:512.000 - response_length/min:67.000 - response_length/clip_ratio:0.016 - prompt_length/mean:98.406 - prompt_length/max:146.000 - prompt_length/min:69.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.296 - timing_s/old_log_prob:2.354 - timing_s/adv:0.018 - timing_s/update_actor:10.244 - timing_s/step:19.915 - timing_per_token_ms/gen:0.633 - timing_per_token_ms/update_actor:0.575 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:17826.000 - perf/time_per_step:19.915 - perf/throughput:895.096
[36m(TaskRunner pid=75125)[0m Training Progress:   5%|▍         | 84/1740 [34:25<10:37:26, 23.10s/it]
[36m(TaskRunner pid=75125)[0m step:85 - global_seqlen/min:18534.000 - global_seqlen/max:18534.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18534.000 - global_seqlen/balanced_max:18534.000 - global_seqlen/mean:18534.000 - actor/entropy_loss:0.106 - actor/pg_loss:-0.568 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.477 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.380 - actor/lr:0.000 - critic/score/mean:0.609 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.609 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.549 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.549 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:184.109 - response_length/max:387.000 - response_length/min:58.000 - response_length/clip_ratio:0.000 - prompt_length/mean:105.484 - prompt_length/max:177.000 - prompt_length/min:66.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.733 - timing_s/old_log_prob:2.355 - timing_s/adv:0.018 - timing_s/update_actor:10.518 - timing_s/step:18.626 - timing_per_token_ms/gen:0.487 - timing_per_token_ms/update_actor:0.567 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18534.000 - perf/time_per_step:18.626 - perf/throughput:995.057
[36m(TaskRunner pid=75125)[0m Training Progress:   5%|▍         | 85/1740 [34:44<10:00:05, 21.76s/it]
[36m(TaskRunner pid=75125)[0m step:86 - global_seqlen/min:18743.000 - global_seqlen/max:18743.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18743.000 - global_seqlen/balanced_max:18743.000 - global_seqlen/mean:18743.000 - actor/entropy_loss:0.097 - actor/pg_loss:-0.617 - actor/pg_clipfrac:0.003 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.755 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.378 - actor/lr:0.000 - critic/score/mean:0.625 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.625 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.588 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.588 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:187.656 - response_length/max:512.000 - response_length/min:72.000 - response_length/clip_ratio:0.016 - prompt_length/mean:105.203 - prompt_length/max:194.000 - prompt_length/min:71.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.265 - timing_s/old_log_prob:2.364 - timing_s/adv:0.019 - timing_s/update_actor:10.609 - timing_s/step:20.260 - timing_per_token_ms/gen:0.605 - timing_per_token_ms/update_actor:0.566 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18743.000 - perf/time_per_step:20.260 - perf/throughput:925.139
[36m(TaskRunner pid=75125)[0m Training Progress:   5%|▍         | 86/1740 [35:04<9:47:22, 21.31s/it] 
[36m(TaskRunner pid=75125)[0m step:87 - global_seqlen/min:17120.000 - global_seqlen/max:17120.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:17120.000 - global_seqlen/balanced_max:17120.000 - global_seqlen/mean:17120.000 - actor/entropy_loss:0.110 - actor/pg_loss:-0.610 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.593 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.390 - actor/lr:0.000 - critic/score/mean:0.641 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.641 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.593 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.593 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:166.031 - response_length/max:338.000 - response_length/min:68.000 - response_length/clip_ratio:0.000 - prompt_length/mean:101.469 - prompt_length/max:217.000 - prompt_length/min:69.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.073 - timing_s/old_log_prob:2.361 - timing_s/adv:0.018 - timing_s/update_actor:10.623 - timing_s/step:18.079 - timing_per_token_ms/gen:0.477 - timing_per_token_ms/update_actor:0.620 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:17120.000 - perf/time_per_step:18.079 - perf/throughput:946.980
[36m(TaskRunner pid=75125)[0m Training Progress:   5%|▌         | 87/1740 [35:22<9:20:21, 20.34s/it]
[36m(TaskRunner pid=75125)[0m step:88 - global_seqlen/min:18196.000 - global_seqlen/max:18196.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18196.000 - global_seqlen/balanced_max:18196.000 - global_seqlen/mean:18196.000 - actor/entropy_loss:0.104 - actor/pg_loss:-0.592 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.477 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.391 - actor/lr:0.000 - critic/score/mean:0.641 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.641 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.559 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.559 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:179.859 - response_length/max:465.000 - response_length/min:65.000 - response_length/clip_ratio:0.000 - prompt_length/mean:104.453 - prompt_length/max:159.000 - prompt_length/min:70.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:6.578 - timing_s/old_log_prob:2.359 - timing_s/adv:0.019 - timing_s/update_actor:10.395 - timing_s/step:19.354 - timing_per_token_ms/gen:0.571 - timing_per_token_ms/update_actor:0.571 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18196.000 - perf/time_per_step:19.354 - perf/throughput:940.183
[36m(TaskRunner pid=75125)[0m Training Progress:   5%|▌         | 88/1740 [35:42<9:11:53, 20.04s/it]
[36m(TaskRunner pid=75125)[0m step:89 - global_seqlen/min:17390.000 - global_seqlen/max:17390.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:17390.000 - global_seqlen/balanced_max:17390.000 - global_seqlen/mean:17390.000 - actor/entropy_loss:0.115 - actor/pg_loss:-0.530 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.338 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.395 - actor/lr:0.000 - critic/score/mean:0.547 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.547 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.494 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.494 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:172.234 - response_length/max:381.000 - response_length/min:61.000 - response_length/clip_ratio:0.000 - prompt_length/mean:99.484 - prompt_length/max:146.000 - prompt_length/min:64.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.450 - timing_s/old_log_prob:2.353 - timing_s/adv:0.019 - timing_s/update_actor:10.543 - timing_s/step:18.367 - timing_per_token_ms/gen:0.494 - timing_per_token_ms/update_actor:0.606 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:17390.000 - perf/time_per_step:18.367 - perf/throughput:946.799
[36m(TaskRunner pid=75125)[0m Training Progress:   5%|▌         | 89/1740 [36:00<8:57:44, 19.54s/it]
[36m(TaskRunner pid=75125)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=75125)[0m validation generation end
[36m(TaskRunner pid=75125)[0m [prompt] system
[36m(TaskRunner pid=75125)[0m You are Qwen, created by Alibaba Cloud. You are a helpful assistant.
[36m(TaskRunner pid=75125)[0m user
[36m(TaskRunner pid=75125)[0m Janet’s ducks lay 16 eggs per day. She eats three for breakfast every morning and bakes muffins for her friends every day with four. She sells the remainder at the farmers' market daily for $2 per fresh duck egg. How much in dollars does she make every day at the farmers' market? Let's think step by step and output the final answer after "####".
[36m(TaskRunner pid=75125)[0m assistant
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m [response] First, we need to calculate the number of eggs Janet lays in a day. She has 16 eggs per day from the ducks and 3 eggs for breakfast, so the number of eggs laid per day is:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m \[ 16 + 3 = 19 \text{ eggs} \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Next, we need to calculate the number of eggs she eats in a day. She eats 3 eggs for breakfast and 4 eggs for baking, so the number of eggs eaten per day is:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m \[ 3 + 4 = 7 \text{ eggs} \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Therefore, the number of eggs she sells per day is:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m \[ 19 - 7 = 12 \text{ eggs} \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m Since she sells each egg for $2, the total amount of money she makes per day is:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m \[ 12 \times 2 = 24 \text{ dollars} \]
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m So, the amount of money Janet makes every day at the farmers' market is:
[36m(TaskRunner pid=75125)[0m 
[36m(TaskRunner pid=75125)[0m #### 24
[36m(TaskRunner pid=75125)[0m #### 24
[36m(TaskRunner pid=75125)[0m [ground_truth] 18
[36m(TaskRunner pid=75125)[0m [score] 0.0
[36m(TaskRunner pid=75125)[0m local_global_step_folder: checkpoints/verl_examples/gsm8k/global_step_90
[36m(TaskRunner pid=75125)[0m Warning: remove_previous_ckpt_in_save is deprecated, set max_actor_ckpt_to_keep=1 and max_critic_ckpt_to_keep=1 instead
[36m(WorkerDict pid=75383)[0m Checkpoint manager remove previous save local path: /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_80/actor
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving model to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_90/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving checkpoint to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_90/actor/model_world_size_1_rank_0.pt
[36m(WorkerDict pid=75383)[0m [rank-0]: Saving extra_state to /home/ubuntu/adversarial-training/example/checkpoints/verl_examples/gsm8k/global_step_90/actor/extra_state_world_size_1_rank_0.pt
[36m(TaskRunner pid=75125)[0m step:90 - global_seqlen/min:18341.000 - global_seqlen/max:18341.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:18341.000 - global_seqlen/balanced_max:18341.000 - global_seqlen/mean:18341.000 - actor/entropy_loss:0.123 - actor/pg_loss:-0.546 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.899 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.380 - actor/lr:0.000 - val/test_score/openai/gsm8k:0.479 - critic/score/mean:0.578 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.578 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.494 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.494 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:184.047 - response_length/max:512.000 - response_length/min:59.000 - response_length/clip_ratio:0.016 - prompt_length/mean:102.531 - prompt_length/max:163.000 - prompt_length/min:78.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:7.285 - timing_s/old_log_prob:2.366 - timing_s/adv:0.018 - timing_s/update_actor:10.607 - timing_s/testing:31.233 - timing_s/save_checkpoint:12.142 - timing_s/step:63.653 - timing_per_token_ms/gen:0.618 - timing_per_token_ms/update_actor:0.578 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:18341.000 - perf/time_per_step:63.653 - perf/throughput:288.139
[36m(TaskRunner pid=75125)[0m Training Progress:   5%|▌         | 90/1740 [37:04<15:01:21, 32.78s/it]
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:773: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(WorkerDict pid=75383)[0m /home/ubuntu/adversarial-training/.venv/lib/python3.10/site-packages/torch/distributed/fsdp/_state_dict_utils.py:711: UserWarning: When using ``NO_SHARD`` for ``ShardingStrategy``, full_state_dict willbe returned.
[36m(WorkerDict pid=75383)[0m   warnings.warn(
[36m(TaskRunner pid=75125)[0m step:91 - global_seqlen/min:17779.000 - global_seqlen/max:17779.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:17779.000 - global_seqlen/balanced_max:17779.000 - global_seqlen/mean:17779.000 - actor/entropy_loss:0.095 - actor/pg_loss:-0.543 - actor/pg_clipfrac:0.004 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.846 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.459 - actor/lr:0.000 - critic/score/mean:0.578 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.578 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.512 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.512 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:168.797 - response_length/max:327.000 - response_length/min:39.000 - response_length/clip_ratio:0.000 - prompt_length/mean:109.000 - prompt_length/max:186.000 - prompt_length/min:68.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.135 - timing_s/old_log_prob:2.359 - timing_s/adv:0.019 - timing_s/update_actor:10.433 - timing_s/step:17.948 - timing_per_token_ms/gen:0.475 - timing_per_token_ms/update_actor:0.587 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:17779.000 - perf/time_per_step:17.948 - perf/throughput:990.564
[36m(TaskRunner pid=75125)[0m Training Progress:   5%|▌         | 91/1740 [37:22<12:58:34, 28.33s/it]
[36m(TaskRunner pid=75125)[0m step:92 - global_seqlen/min:17620.000 - global_seqlen/max:17620.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:17620.000 - global_seqlen/balanced_max:17620.000 - global_seqlen/mean:17620.000 - actor/entropy_loss:0.099 - actor/pg_loss:-0.599 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.186 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.408 - actor/lr:0.000 - critic/score/mean:0.609 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.609 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.579 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.579 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:173.188 - response_length/max:402.000 - response_length/min:52.000 - response_length/clip_ratio:0.000 - prompt_length/mean:102.125 - prompt_length/max:153.000 - prompt_length/min:71.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:6.089 - timing_s/old_log_prob:2.363 - timing_s/adv:0.019 - timing_s/update_actor:10.371 - timing_s/step:18.844 - timing_per_token_ms/gen:0.549 - timing_per_token_ms/update_actor:0.589 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:17620.000 - perf/time_per_step:18.844 - perf/throughput:935.064
[36m(TaskRunner pid=75125)[0m Training Progress:   5%|▌         | 92/1740 [37:40<11:40:00, 25.49s/it]
[36m(TaskRunner pid=75125)[0m step:93 - global_seqlen/min:17973.000 - global_seqlen/max:17973.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:17973.000 - global_seqlen/balanced_max:17973.000 - global_seqlen/mean:17973.000 - actor/entropy_loss:0.089 - actor/pg_loss:-0.599 - actor/pg_clipfrac:0.003 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.359 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.401 - actor/lr:0.000 - critic/score/mean:0.594 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.594 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.576 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.576 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:175.250 - response_length/max:362.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:105.578 - prompt_length/max:169.000 - prompt_length/min:72.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.291 - timing_s/old_log_prob:2.360 - timing_s/adv:0.019 - timing_s/update_actor:10.348 - timing_s/step:18.019 - timing_per_token_ms/gen:0.472 - timing_per_token_ms/update_actor:0.576 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:17973.000 - perf/time_per_step:18.019 - perf/throughput:997.445
[36m(TaskRunner pid=75125)[0m Training Progress:   5%|▌         | 93/1740 [37:58<10:38:07, 23.25s/it]
[36m(TaskRunner pid=75125)[0m step:94 - global_seqlen/min:17718.000 - global_seqlen/max:17718.000 - global_seqlen/minmax_diff:0.000 - global_seqlen/balanced_min:17718.000 - global_seqlen/balanced_max:17718.000 - global_seqlen/mean:17718.000 - actor/entropy_loss:0.088 - actor/pg_loss:-0.514 - actor/pg_clipfrac:0.003 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:4.809 - perf/mfu/actor:0.000 - perf/max_memory_allocated_gb:16.965 - perf/max_memory_reserved_gb:19.166 - perf/cpu_memory_used_gb:5.399 - actor/lr:0.000 - critic/score/mean:0.531 - critic/score/max:1.000 - critic/score/min:0.000 - critic/rewards/mean:0.531 - critic/rewards/max:1.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.489 - critic/advantages/max:1.000 - critic/advantages/min:0.000 - critic/returns/mean:0.489 - critic/returns/max:1.000 - critic/returns/min:0.000 - response_length/mean:174.516 - response_length/max:381.000 - response_length/min:69.000 - response_length/clip_ratio:0.000 - prompt_length/mean:102.328 - prompt_length/max:170.000 - prompt_length/min:71.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:5.569 - timing_s/old_log_prob:2.372 - timing_s/adv:0.018 - timing_s/update_actor:10.539 - timing_s/step:18.501 - timing_per_token_ms/gen:0.499 - timing_per_token_ms/update_actor:0.595 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:17718.000 - perf/time_per_step:18.501 - perf/throughput:957.672
[36m(TaskRunner pid=75125)[0m Training Progress:   5%|▌         | 94/1740 [38:17<9:58:41, 21.82s/it] 
